% 导言区
\documentclass[a4paper,zihao=-4,linespread=1]{ctexrep}

\usepackage[]{mathrsfs}
\usepackage[]{animate}
\usepackage{color}
\usepackage{booktabs}
\usepackage{titlesec}
\usepackage{titletoc}
\usepackage[titletoc]{appendix}
\usepackage[normalem]{ulem}         % 关于下划线的一个宏包
\usepackage[]{indentfirst}          % 强制段首缩进
\usepackage[]{bm}
\usepackage[]{amsmath}
\usepackage[]{esint}
\usepackage[]{amssymb}
\usepackage[]{extarrows}
\usepackage{graphicx}
\usepackage[]{subfigure}
\usepackage[colorlinks,linkcolor=blue,bookmarksopen=true,bookmarksnumbered=true,citecolor=blue]{hyperref}             % 目录点击跳转
\usepackage[dvipsnames,svgnames]{xcolor}
\usepackage{tcolorbox}
\tcbuselibrary{breakable}   % 分页
\tcbuselibrary{skins}       % 箱子分页
\usepackage[]{tikz}
\usepackage[]{pgfplots}
\pgfplotsset{compat=1.18}
\usepackage{newtxtext}
\usepackage[strict]{changepage} % 提供一个 adjustwidth 环境
\usepackage{framed}             % 实现方框效果
\usetikzlibrary{positioning}   % tikz绘图相对位置
\tikzset{elegant/.style={smooth,thick,samples=50,cyan}}
\usepackage[]{newtxmath}
\usepackage[]{bbm}
\usepackage[]{relsize}
\usepackage[]{braket}
\usepackage{siunitx}
\DeclareSIUnit\angstrom{\text {Å}}

% 定义公式环境
\newenvironment{lequation}{\large\begin{equation}}{\end{equation}}
\newenvironment{sequation}{\small\begin{equation}}{\end{equation}}
\newenvironment{tequation}{\tiny\begin{equation}}{\end{equation}}
% 向下的长箭头
\newcommand\longdownarrow[1]{\mathrel{\scalebox{1}[#1]{$\downarrow$}}}
% 定义方框
% 陈述性语句
\newtcolorbox[]{proposition}[2][]{title = \textbf{#2}, colback=Salmon!20, colframe=Salmon!90!Black,breakable, enhanced jigsaw}
% 历史注记
\newtcolorbox[]{history}[2][]{title = \textbf{#2}, colback=Emerald!10, colframe=cyan!40!black,breakable, enhanced jigsaw}
% 定理
\newtcolorbox[]{theorem}[2][]{title=\textbf{#2}, colback=red!5,colframe=red!75!black,breakable, enhanced jigsaw}
% 定义
\newtcolorbox[]{define}[2][]{title=\textbf{#2},colback=SeaGreen!10!CornflowerBlue!10,colframe=RoyalPurple!55!Aquamarine!100!,breakable, enhanced jigsaw}
% 思考注记
\definecolor{formalshade}{rgb}{0.99,0.97,0.93} % 文本框颜色
\newenvironment{thinknote}{%
\def\FrameCommand{%
\hspace{1pt}%
{\color{BurlyWood}\vrule width 2pt}%
{\color{formalshade}\vrule width 4pt}%
\colorbox{formalshade}%
}%
\MakeFramed{\advance\hsize-\width\FrameRestore}%
\noindent\hspace{-4.55pt}% disable indenting first paragraph
\begin{adjustwidth}{}{7pt}%
\vspace{2pt}\vspace{2pt}%
}
{%
\vspace{2pt}\end{adjustwidth}\endMakeFramed%
}

\setlength{\parindent}{4em}
\title{Notes of Griffiths Introduction to QM}   % 添加标题
\author{郑卜凡}                     % 添加作者
\date{\today}                             %最后更新日期

\begin{document}
    \maketitle              %制作封面
    \tableofcontents        %制作目录
    \setcounter{page}{0}
    \thispagestyle{empty}
    \chapter{波函数}
    \section{薛定谔方程}
    \begin{lequation}\label{S-1-D}
        \boxed{
            i\hbar\frac{\partial \Psi\left(x,t\right)}{\partial t}=-\frac{\hbar^{2}}{2m}\frac{\partial^{2}\Psi\left(x,t\right)}{\partial x^{2}}+
            V\left(x,t\right)\Psi\left(x,t\right)
        }
    \end{lequation}
    \begin{lequation}\label{S-3-D}
        \boxed{
            i\hbar\frac{\partial \Psi\left(\bm{r},t\right)}{\partial t}=\left[-\frac{\hbar^{2}}{2m}\nabla^{2}+
            V\left(\bm{r},t\right)\right]\Psi\left(\bm{r},t\right) 
        }
    \end{lequation}


    上面给出的公式中第一个是一维形式, 第二个是三维一般形式。对于某些公式推导上, 使用薛定谔方程时, 常常是对方程两边进行共轭操作\footnote[1]{物理实质可以理解
    为时间反演对称性}（以一维形式为例）也即：
    \begin{lequation}
        -i\hbar\frac{\partial \Psi^{*}\left(x,t\right)}{\partial t}=-\frac{\hbar^{2}}{2m}\frac{\partial^{2}\Psi^{*}\left(x,t\right)}{\partial x^{2}}+
        V\left(x,t\right)\Psi^{*}\left(x,t\right)
    \end{lequation}


    注意到上式的导出我们假定势能函数是实变函数, 这是有道理的, 但是书后面的习题\footnote[2]{详见第三版Problem1.17}也给出了一个例子, 那就是在不稳定的系统中, 找到粒子的概率不是守恒的, 也就是说$P$依赖于时间。
    这时如果引入含有虚部项的势能就可以很好地解释这一点。在量子力学中Schr{\"o}dinger方程的地位和牛顿第二定律一样, 现在只是描述粒子位置的函数变成了波函数。


    Born后面给波函数一个统计上的解释, 这也就说明了在量子力学中的不确定性, 我们无法再像牛顿运动定律一样精确的预言一个例子之后的运动, 我们只能给出它之后在某处的\uwave{概率}是多少
    \begin{proposition}{波函数的统计诠释}
        以一维情形为例, Born在统计上给出了对于波函数的解释, 他认为当一个微观粒子处于状态$\Psi\left(\bm{r},t\right)$时, 表示在$t$时刻在$x$处发现粒子的\uwave{概率}, 更准确的说\footnote[0]{一个常用的代换是$\left|\Psi\left(x,t\right)\right|^{2}=
        \Psi^{*}\left(\left(x,t\right)\right) \Psi\left(x,t\right) $}
        \begin{lequation}
            \int_{a}^{b}\left|\Psi\left(x,t\right)\right|^{2}dx=\left\{\text{$t$时刻在$\left[a,b\right]$内\\发现粒子的概率}\right\}
        \end{lequation}
    
    \end{proposition}
    自然的, 我们会问, 测量时我们会发现粒子处于某点(C点), 那么测量之前粒子在哪？历史上有三种观点
    \begin{history}{测量前粒子在哪？}
        \textbf{1.现实主义学派:粒子还是在C点}, 这种观点完全否定了量子理论的不确定性, 也是爱因斯坦一直坚信的观点;\\
        \textbf{2.正统学派:粒子哪也不在}, 这种观点认为正是我们的测量\uwave{迫使}粒子在C点, 这个观点被广泛接受, 但到底什么是测量还有待讨论;\\
        \textbf{3.不可知论学派:拒绝回答}, 这种观点认为\uwave{测量前}本身就是难以定义的, 去讨论测量前粒子的位置也是没有意义的。
    \end{history}
    现代量子理论在实验上说明了正统学派的正确性\footnote[1]{John Bell在1964年派排除了不可知论}, 有一点需要注意, 测量会导致波函数的坍塌(\ref{fig-1.1}), 坍塌成了一个类似于狄拉克delta函数的图像, 在波函数还没有按照薛定谔方程重新弥散开来的时候继续测量, 我们会发现测量结果不变, 也
    就是说\uwave{测量完全改变了波函数}, 导致连续的测量得到的结果是一样的。

    既然波函数在统计上可以解释为概率密度分布函数, 那么一定要满足\textbf{归一化条件}
    \begin{proposition}{波函数归一化条件}
        \begin{lequation}\label{normalized}
            \int_{-\infty}^{\infty}\left|\Psi\left(x,t\right)\right|^{2}dx=1
        \end{lequation}
    \end{proposition}
    而且从薛定谔方程的线性性可以看出, 如果$\Psi$是方程的解, 那么$A\Psi$也一定是方程的解, 这里的A就类似于微分方程通解里面的系数, 你需要使用归一化条件去确定它, 求解出来的$A$是不需要考虑相位问题的, 不会在物理上产生任何影响, 你只需要确定
    它的模长就可以了, 下面一个关于归一化的定理让我们能更简单的对波函数进行归一化。
    \begin{theorem}{$A$是一个与时间无关的常数}
        \begin{lequation}
            \label{normalized-independent-time}
            \frac{d}{dt}\int_{-\infty}^{\infty}\left|\Psi\left(x,t\right)\right|^{2}dx=0
        \end{lequation}
    \end{theorem}
    由于这个定理的正确性, 我们找到波函数的一个可能解后, 只需要任意代入一个$t$的值, 然后将波函数乘上一个常数因子$A$对波函数进行全空间积分解出$A$的大小即得到了波函数的真正有物理意义的解, \textbf{任何无法进行归一化的解(比如$\Psi=0$)都要舍去}。
    \section{力学量的期望值和标准差}
    \begin{define}{数学上的定义: 平均值和标准差}
        \begin{center}
        \begin{math}
            \displaystyle
            \left \langle x \right \rangle \overset{\text{def}}{=}\int_{-\infty}^{\infty}x\rho(x)dx \qquad\qquad\qquad
            \sigma _{x}\overset{\text{def}}{=}\int_{-\infty }^{\infty } (x-\left \langle x \right \rangle )^2\rho(x)dx
        \end{math}
        \end{center}
        其中$\rho(x)$是概率密度函数, 把上面的$x$换成$f(x)$就可以得到某个一般量的平均值和标准差
    \end{define}
    根据上面的定义我们可以得到一个更加常用的计算标准差的公式: $\sigma(x)=\sqrt{\left \langle x^2 \right \rangle-\left \langle x \right \rangle^2}$。
    
    在进一步说明力学量的平均值的时候要先明确平均值的意义, 就比如说发现粒子所处位置的平均值, 你不能将其理解成连续测量一个系统很多次之后计算得到的平均值, 因为前面就说过
    波函数会由于测量而坍缩, 连续多次对一个系统的测量得到的结果是一致的! 这里对平均值的定义是对于\uwave{系综}的, 也就是你需要对大量相同状态下的系统进行测量来求平均值, 或
    者简单一点, 对一个系统测量很多次, 但每次测量要隔一段时间要等待波函数重新回到测量前未坍缩的样子。
    \begin{proposition}{位置和动量的算符}
        \begin{center}
            \begin{math}
                \displaystyle
                \hat{x}=[x] \qquad\qquad\qquad\qquad \hat{p}=\left[-i\hbar\frac{\partial}{\partial x}\right]    
            \end{math}
        \end{center}
        值得一提的是, 上面的动量算符是利用$\left \langle p \right \rangle=m\frac{d\left \langle x \right \rangle}{dt}$得出来的
        \footnote[0]{这里的$\left \langle x \right \rangle$必须要事先写成关于$t$的函数, 另见Problem1.16(c)}
    \end{proposition}
    \begin{theorem}{任意一个力学量的统计量}
        \begin{lequation}
            \left \langle Q\left(x,p\right) \right \rangle=\int \Psi^{*}\left[Q\left(x,-i\hbar\frac{\partial}{\partial x}\right)\right]\Psi dx
        \end{lequation}
        \begin{equation}
            \sigma_Q = \sqrt{\left \langle Q^2 \right \rangle-\left \langle Q \right \rangle^2}
        \end{equation}
    \end{theorem}
    上面的定理说明了在量子力学中\uwave{算符}显得尤为重要, 你要计算一个力学量$Q$的平均值只要把这个力学量的算子\uwave{夹在}波函数中间再积分即可。确定一个力学量的算子时, 先将
    这个力学量由经典力学的公式表示成关于位置$x$和动量$p$的函数然后将$x$和$p$全部换成对应的算符即可。\footnote[1]{我们提倡使用算符这个新的工具去计算, 但有时候你会发现, 得到了$\left \langle x \right \rangle(t) $后直接使用
    $\left \langle p \right \rangle=\frac{d\left \langle x \right \rangle}{dx}$更快。有时候直接使用定义(波函数是实质是测量到粒子在位置$x$的概率密度分布函数), 用$\int x\left| \Psi(x,t)\right|dx$直接计算也能达到事半功倍
    的效果}
    \section{海森堡不确定性原理}
    这个原理在历史上曾经被称作\uwave{测不准原理}, 有很大的误导性, 实际上这个原理与测量误差毫无关系, 这是一个量子力学本身决定的原理。它表明了你对系统位置了解的越多, 比如说你把系统限制在某个
    确定的轨道狭槽内, 那么你对系统动量的了解程度一定越低, 测出来的动量分布肯定越是分散。其中动量与波函数之间的关系最早由德布罗意(de Broglie)给出:
    \begin{center}
    \begin{math}
        \displaystyle
        \boxed{
            p=\frac{h}{\lambda}=\frac{2\pi\hbar}{\lambda}
        }
    \end{math}
    \end{center}
    \begin{theorem}{Heisenberg Uncertainty Principle}
        \begin{lequation}
            \sigma_x\sigma_p \geq \frac{\hbar}{2} 
        \end{lequation}
    \end{theorem}
    \newpage
    \begin{figure}[htbp]
        \label{fig-1.1}
        \begin{tikzpicture}[scale=0.4] %缩放，还可以设置xscale, yscale
        \draw[->](4,-2)--(4,8) node[above]{$\Psi (x,0^-)$};
        \draw[->](0,2)--(12,2) node[below]{$x$};  % 画坐标轴
        \draw (4,2) node[below right]{$O$};
        \draw[elegant,domain=0:12] plot(\x,{5.5*exp(-(\x-6)^2/4.56)+2});
        \draw[dashed,red] (8,2)--(8,8);
        \draw (8,2) node[below]{$C$};
        \end{tikzpicture}  
        \hspace{4em}
        \begin{tikzpicture}[scale=0.4] %缩放，还可以设置xscale, yscale
        \draw[->](4,-2)--(4,8) node[above]{$\Psi (x,0^+)$};
        \draw[->](0,2)--(12,2) node[below]{$x$};  % 画坐标轴
        \draw (4,2) node[below right]{$O$};
        \draw[dashed,red] (8,2)--(8,8);
        \draw (8,2) node[below]{$C$};
        \draw[->,red] (8,2)--(8,6);
        \draw (8,6) node[right]{$\infty$};
        \end{tikzpicture}  
        \caption{在$t=0$时刻测量, 波函数将在$C$处坍塌为狄拉克$\delta$函数}
    \end{figure}
    \begin{history}{关于sch\"{o}dinger方程}
        薛定谔方程在现在的物理意义上来看应该认为是量子力学的一条基本假设, 因为这个公式并不是推出来的, 而是在受到德布罗意物质波的启发下\textbf{猜}出来的。
        薛定谔的博士导师试图让它根据德布罗意的观点找出一个对应的波函数描述, 最开始想从相对论来构建方程, 后来走不通, 有的人说薛定谔是受到经典力学的波动方程
        启发, 类比构造薛定谔方程的; 还有一种观点也比较有根据, 认为薛定谔是受到了它导师的导师玻尔兹曼的启发, 利用热力学第二定律中的玻尔兹曼熵$S=k\ln W$,一步步
        构建出来的薛定谔方程, 具体做法就是将$k$换成$\hbar$, 然后根据能量量纲将$S$换为作用量$H$, 由于是波动方程, 所以还要在指数项上加一个虚数单位, 方程就
        变成了这样:$$W=e^{\frac{iH}{\hbar}}$$然后经典力学里面刚好在正则变换中有一个Hamilton-Jacobi方程(这里的$S$不是熵)$$\frac{\partial S}{\partial t}+H=0$$
        然后带入后将$W$换成更加\textbf{量子力学}的$\Psi$, 将$H$写成算符$\hat{H}$。

        对的, 整个过程就是这么的没有道理, 所以我们说这个方程是猜出来的, 后来海森堡证明了波动力学与其创立的矩阵力学是等价的。薛定谔自己其实也没搞清楚他搞出来
        的波函数有什么意义, 也是后来波恩给出了个统计解释, 不禁感叹新兴学科的发展总是迂回曲折!
    \end{history}
    \newpage
    \chapter{定态Schr\"{o}dinger方程}
    \section{定态和分离变量法}
    列出Sch\"{o}dinger方程后的下一步就是解出系统对应的波函数, 首先我们应该从最最初等的分离变量法来解方程, 毫无疑问我们只能通过它来\uwave{猜出}解空间
    的一小部分子集, 但是这种方法得出来的解却具有非常重要的物理意义, 后面的一系列讨论都默认势能函数不随时间变化(保守场)。

    分离变量法的基本思想就是将$\Psi$拆分为两个函数, 一个只关于$x$, 一个只关于$t$, 即$\Psi(x,t)=\psi(x)\phi(t)$, 带入到Sch\"{o}dinger方程(\ref{S-1-D})我们可以得到
    下面的式子\footnote[1]{$\phi(t)$附带的常数项我们合并到$\psi(x)$里面了,反正最后是对$\Psi$进行归一化}。
    \begin{lequation}
        \label{wiggle-function}
        \boxed{
            \varphi(t)=e^{-\frac{iEt}{\hbar}}
        }
    \end{lequation}
    \begin{lequation}
        \label{time-independent-equation}
        \boxed{
            -\frac{\hbar^2}{2m}\frac{d^2\psi(x)}{dx^2}+V(x)\psi(x)=E\psi(x)
        }
    \end{lequation}

    式\ref{wiggle-function}你可以称之为\uwave{wiggle-function}, 它只和时间相关而且你如果使用Euler公式\footnote[2]{$e^{i\theta}=\cos\theta+i\sin\theta$}, 你
    会发现它是按照正弦规律进行\uwave{振动}的, 暂且就先把它当成是波函数里面的振荡项。后面的式子(\ref{time-independent-equation})及其重要, 它就是我们要
    谈的\textbf{定态薛定谔方程}, 不含时间, 其中的$E$实际上代表着系统的能量(哈密顿量\footnote[3]{哈密顿量就是动能加势能, 与系统的拉格朗日量对应, 后者是动能减势能})。
    \begin{define}{哈密顿算子}
        \begin{center}
           \begin{math}
            \displaystyle
            \hat{H}=\frac{\hat{p}^2}{2m}+[V]=-\frac{\hbar^2}{2m}\frac{\partial^2}{\partial x^2}+V
        \end{math} 
        \end{center}
    \end{define}
    使用哈密顿算子可以简化方程的书写为$\hat{H}\psi=E\psi$。下面列出来这些定态解重要的性质。
    \begin{theorem}{定态解$\Psi(x,t)=\psi(x)e^{iEt/\hbar}$}
        定态薛定谔方程的每个解都对应某个能量为$E$的\uwave{定态系统}:\\
        1.每个定态解对应系统能量(Hamiltonian)无论何时测量都是$E$,很容易通过证明它的方差和平均值都不随时变来证明它, 其它力学量的平均值也不随时变;\\
        2.定态解的时间项对概率密度没有任何贡献, i.e.用$\psi$替代$\Psi$去计算物理量的平均值不会产生任何差异, 因此有时候也刻意不区分两者;\\
        3.由于定态解能量的选取是任意的\footnote{实际上不完全任意}, 所以存在无穷多个定态解, 一般的解就是这些由分离变量得出来的定态解的\uwave{线性组合}
        \begin{lequation}
            \label{find_c}
            \boxed{
                \Psi(x,t)=\sum_{n=1}^{\infty}c_n\psi_n e^{-iE_nt/\hbar}
            }
        \end{lequation}
        其中常数$c$\footnote{可以是复数}需要使用初始波函数去确定。\\
        特别注意, 现在由定态解合成的一般解\textbf{不一定}是定态的, 而且比较遗憾的是一般你不能把它写成一个闭公式, 只能用无穷级数表示。
    \end{theorem}
    由于波函数需要满足归一化条件(eq.\ref{normalized}), 所以所有不满足归一化条件的解我们都应舍去, 他们是没有物理意义的, 所以这一步可以帮我们排除很多定态解
    的可能性。
    \begin{thinknote}
        这里实际上定态并不是我们真正要求的解, 我们要求的解是这些解的线性组合, 但是我们还是要将他们($\psi$)进行归一化处理, 但没有关系, 反正归一化只是乘上
        一个常数, 但在这里我们进行归一化后可以使得解的物理意义更加明朗, 更重要的是它会简化我们后续的数学对解的性质上的讨论。叠加后, 定态解前面的系数也更加
        具有物理意义。
    \end{thinknote}
    \begin{proposition}{定态解可归一化必要条件}
        1.能量$E$的虚部为零, 是一个实数;\\
        2.能量$E$要大于$V(x)$的最小值, 也就是说的能量不能一直小于势能\footnote{这个蛮好理解的, 因为动能项始终非负}。
    \end{proposition}
    \begin{proposition}{$c_n$的物理意义}
        一般解前面对于定态解$\Psi_n(x,t)=\psi(x)e^{-iE_nt/\hbar}$的权重$\left|c_n\right|^2$表示\textbf{测量到系统能量值为$E_n$的概率}, 这也意味着, 你
        对一个系统进行测量, 只可能得到它所包含的定态解分量对应的能量值, 一定是一组离散的值。
    \end{proposition}
    自然的, $c_n$也要满足归一化条件(eq.\ref{normalized-c})。注意, 我们上面提到是说在某次测量时发现系统能量为$E_n$, 而不是说系统在测量时处于能量为$E_n$的
    一个定态, 系统的态始终是没有发生改变的。而且我们也注意到系统的能量并不是一成不变的, 不同的测量显现出来的能量也不同, 但是系统的能量的平均值是随时间或者测量改变
    的(eq.\ref{energy-conservation}), 这一个性质就是在微观量子效应下的\textbf{能量守恒定律}。
    \begin{lequation}
        \label{normalized-c}
        \sum_{n=1}^{\infty}\left|c_n\right|^2=1
    \end{lequation}
    \begin{lequation}
        \label{energy-conservation}
        \left \langle H \right \rangle=\sum_{n=1}^{\infty}\left|c_n\right|^2E_n 
        \Rightarrow \frac{\partial H}{\partial t}=0\footnote[1]{利用这个性质, 你可以进一步简化平均能量的计算, 即计算$\left \langle H \right \rangle=\int \Psi(x,t)^*\hat{H}\Psi(x,t) dx$, 你可以直接代入$t=0$进一步
        简化运算, 因为这个性质保证了平均能量与时间无关。}
    \end{lequation}
    \section{一维无限深方势阱}
    \begin{define}{The Infinite Square Well}
        粒子如果处于无限深势阱中, 那么它的势能可以写成下面的这种形式:
        \begin{center}
            \begin{math}
            \displaystyle
            V(x) = \begin{cases}
                    0, &0\leq x \leq a\\
                    \infty, & \text{otherwise}
                    \end{cases}
            \end{math}
        \end{center}
        就像是在$x=0$和$x=a$处由两堵墙, 粒子被困在两堵墙之间, 然而在两堵墙之间它可以\uwave{自由移动}。
    \end{define} 
    首先我们来看一下边界条件, 显然, 在势阱之外$\Psi(x,t)\equiv 0$, 同样也应该有$\Psi(0,t)=\Psi(a,t)=0$。根据定态薛定谔方程(eq.\ref{time-independent-equation}), 我
    们要去求解的是一个分段函数形式给出的微分方程, 不妨分段去考虑它, $(0,a)$之外波函数恒等于$0$, 对于$(0,a)$那一部分, 势能为$0$, 定态薛定谔方程写成\footnote{注意到$E\leq0$时的解是平凡的或者不能归一化的}:
    \begin{lequation}
        \boxed{
            -\frac{\hbar^2}{2m}\frac{d^2\psi}{dx^2}=k^2\psi,\quad k=\frac{\sqrt{2mE}}{\hbar}
        }
    \end{lequation}
    \begin{thinknote}
        实际上这里的$k$从经典力学上看可以理解为\textbf{角波数}, $k=2\pi/\lambda\xlongequal[]{de-Broglie-eq.}p/\hbar$, 使用经典力学的观点来看,粒
        子的能量为$E$, 那么动量为$\sqrt{2mE}$。
    \end{thinknote}
    这就是一个自由振子的数学模型, 代入边界条件\footnote[2]{$\psi(0)=\psi(a)=0$, 而且这里悄然已经利用了$\psi(x)$的连续性, 后面会再次提到}并且归一化可以得到:
    \begin{lequation}
        \boxed{
            \psi_n(x)=\sqrt{\frac{2}{a}}\sin\left(\frac{n \pi}{a}x\right),\quad k=\frac{n \pi}{a}
        }
    \end{lequation}
    \begin{lequation}
        \boxed{
            E_n=\frac{n^2\pi^2\hbar^2 }{2ma^2}
        }
    \end{lequation}
    其中\textbf{$n$是正整数}。计算的时候你会发现, 两个边界条件实际上不能完全确定微分方程解的两个常数项, 但是它却限制了$ka=n\pi(n=1,2,3,\ldots)$, 而$k$
    的值和能量是相关的, 所以这也就说明了\textbf{量子力学系统中的定态解的能量这个时候只能取一系列离散数值}\footnote[3]{对于束缚态是离散的, 对散射态不是}, 又考虑到系统的真实解是定态解的叠加, 而且每次测量系统的能量
    时都会返回某个定态解的能量, 这也就体现了量子力学中\textbf{能量的不连续性}, 真正确定另一个常数的条件是归一化条件\footnote[4]{回想一下对$\Psi$归一化等价于对$\psi$归一化}。

    完整写下定态的波函数应该为:
    \begin{lequation}
        \Psi(x,t)=\sqrt{\frac{2}{a}}\sin\left(\frac{n \pi}{a}x\right)e^{in^2\pi^2\hbar t/2ma^2}
    \end{lequation}
    
    $n=1$时我们称作\textbf{基态}, 其它的我们称为\textbf{激发态}。观察不同解在$t=0$时的波函数(fg.\ref{fig-2.1})我们可以发现, 这些定态本质上就是一系列\uwave{驻波}, 势阱的
    两个边界是它的两个波节。
    \begin{figure}[htbp]
        \centering
        \subfigure[$n=1$]{
            \begin{tikzpicture}[scale=0.6] %缩放，还可以设置xscale, yscale
            \draw[->](0,-3)--(0,3) node[above]{$\Psi (x,0)$};
            \draw[->](-2,0)--(8,0) node[below]{$x$};  % 画坐标轴
            \draw (0,0) node[below right]{$O$};
            \draw (6,0) node[below]{$a$};
            \draw[elegant,domain=0:6] plot(\x,{3*sin(\x*pi/6 r)});
            \draw[-,red] (-2,0)--(0,0);
            \draw[-,red] (6,0)--(8,0);
        \end{tikzpicture} 
        }
        \subfigure[$n=2$]{
            \begin{tikzpicture}[scale=0.6] %缩放，还可以设置xscale, yscale
            \draw[->](0,-3)--(0,3) node[above]{$\Psi (x,0)$};
            \draw[->](-2,0)--(8,0) node[below]{$x$};  % 画坐标轴
            \draw (0,0) node[below right]{$O$};
            \draw (6,0) node[below]{$a$};
            \draw[elegant,domain=0:6] plot(\x,{3*sin(2*\x*pi/6 r)});
            \draw[-,red] (-2,0)--(0,0);
            \draw[-,red] (6,0)--(8,0);
        \end{tikzpicture} 
        } 
        \subfigure[$n=3$]{
           \begin{tikzpicture}[scale=0.6] %缩放，还可以设置xscale, yscale
            \draw[->](0,-3)--(0,3) node[above]{$\Psi (x,0)$};
            \draw[->](-2,0)--(8,0) node[below]{$x$};  % 画坐标轴
            \draw (0,0) node[below right]{$O$};
            \draw (6,0) node[below]{$a$};
            \draw[elegant,domain=0:6] plot(\x,{3*sin(3*\x*pi/6 r)});
            \draw[-,red] (-2,0)--(0,0);
            \draw[-,red] (6,0)--(8,0);
        \end{tikzpicture}   
        }
        \caption{不同的$n$对应不同的驻波波形}
        \label{fig-2.1}
    \end{figure}

    下面要谈到的性质虽然是根据无限深势阱总结来的, 但是他们却是普遍适用的\footnote[5]{$\delta$符号的相关定义见附录A}。
    \begin{theorem}{定态解的重要性质定理}
        1.不管势能本身是否具有对称性, 定态波函数总是关于势阱的中心成奇函数或偶函数(即关于中心轴对称或中心对称), 且随着$n$的变化交替出现;\\
        2.不管势能本身形状如何, 波函数的波节(零点)个数总是随着能量的增大而增大, 且公差为$1$;\\
        $\bigstar$3.\textbf{定态解之间相互正交}\footnote{回忆一下我们已经对$\psi$进行归一化}\footnote{积分为全空间, 对于无限深势阱积分限为$(0,a)$。
        实际上这里使用术语\uwave{本征函数}相互正交更好, 因为我们描述的是$\psi$而非$\Psi$之间的关系。}
        \begin{lequation}
            \label{orthogonal}
            \int \psi_m(x)^*\psi_n(x) dx=\delta_{mn}
        \end{lequation} 
        $\bigstar$4.\textbf{定态解集合是完备的}:这个意思就是说你可以使用定态解的线性组合来表示\textbf{任何连续函数}, 对于这里的无限深势阱, 实质就是
        \uwave{傅里叶级数}。
    \end{theorem}
    上面的性质第四点说明了我们始终可以找到一组合适的$c_n$去满足初始波函数, 而如何去求这些$c_n$又是基于定态解的正交性(eq.\ref{orthogonal}), 使用傅里叶方法我们可以
    很容易的得到$c_n$\footnote[1]{$\Psi(x,0)$是初始波函数, 如果初始波函数不是在$t=0$时刻给定的, 你可能要额外考虑一下wiggle-function项(eq.\ref{wiggle-function})(更改时间原点也是一个不错的选择, 复习一下波动学里面的操作)}:
    \begin{lequation}
        \boxed{
            c_n=\int \psi_n(x)^*\Psi(x,0) dx
        }
    \end{lequation}

    使用正交性你还可以去证明\footnote[2]{分别基于初始波函数的归一化和定态薛定谔方程的算子表示法}eq.\ref{normalized-c}和eq.\ref{energy-conservation}。
    \begin{thinknote}
        上面的两个证明书上都有, 实际上你也可以证明按照上面的方法解出来的系统的波函数, $\Psi$已经自动归一化。但这是多此一举的, 因为无论是初始波函数, 还是确定$c_n$后的完整波函数, 波函数都是满足薛定谔方程的, 在
        前面的章节我们就说明了如果$\Psi$在某一时刻是归一化的, 那么之后任一时刻它也是归一化的(eq.\ref{normalized-independent-time})
    \end{thinknote}
    在计算能量平均值的级数时, 经常会涉及黎曼函数, 这里不做深入展开, 仅仅列出几个常用的和式。
    \begin{define}
        {黎曼$\zeta$函数}
        \begin{center}
            \begin{math}
                \displaystyle
                \zeta(s)\overset{def}{=}\frac{1}{1^s}+\frac{1}{2^s}+\frac{1}{3^s}+\frac{1}{4^s}+\cdots
            \end{math} 
        \end{center}
    \end{define}
    可以很容易的发现下面的等式成立：
    \begin{lequation}
        \boxed{
            \frac{1}{1^s}+\frac{1}{3^s}+\frac{1}{5^s}+\frac{1}{7^s}+\cdots = (2^s-1)\zeta(s)
        }
    \end{lequation}
    $s$为偶数时, 可以求出$\zeta$的精确值, 但对于奇数情况却异常复杂, 下面列出具体表达式和几个值供参考：
    \begin{theorem}{$s$为偶数时的解}
        \begin{center}
            \begin{math}
                \displaystyle
                \zeta(2n)=\eta_n \pi^{2n}
            \end{math}
            \begin{math}
                \displaystyle
                 \eta_1=\frac{1}{6},\qquad\eta_n=\sum_{k=1}^{n-1}(-1)^{n-1}\frac{\eta_{n-k}}{(2k+1)!} + (-1)^{n+1}\frac{n}{(2n+1)!}
            \end{math}
        \end{center}
    \end{theorem}

    \begin{table}[htbp]
        \centering
        \resizebox{\textwidth}{10mm}{
        \begin{tabular}{cccccccc} 
        \hline
        $s$     & $2$                & $4$                  & $6$                   & $8$                    & $10$                     & $12$                         & $14$                          \\ 
        \hline
        value & $\frac{\pi^2}{6}$ & $\frac{\pi^4}{90}$ & $\frac{\pi^6}{945}$ & $\frac{\pi^8}{9450}$ & $\frac{\pi^{10}}{93555}$ & $\frac{\pi^{12}}{638512875}$ & $\frac{2\pi^{14}}{18243225}$  \\
        \hline
        \end{tabular}}
    \end{table}

    \section{简谐振子}
    通过上一节我们已经大致知道了如何去求解特定势能下的波函数, 大致来说就是找到所有的定态解, 每一个解对应一个常量(能量), 这些常量的选取是离散的, 然后我们再
    对求出来的定态解进行叠加, 使用傅里叶方法定下权重即可。现在我们要碰到的势能函数形式是一个二次式, 但方程的求解却困难许多, 但这个工作是很有意义的, 因为任何
    势能函数的驻点附近, 使用Taylor展开, 你都可以将它处理成一个简谐振子的模型。
    \begin{define}{The Harmonic Oscillator}
        势能形式是关于$x$的二次式, 我们使用类似离心势能的形式写出:
        \begin{center}
            \begin{math}
                \displaystyle
                V(x)=\frac{1}{2}m\omega^2x^2
            \end{math}
        \end{center}
    \end{define}
    定态薛定谔方程相应的写成$$-\frac{\hbar^2}{2m}\frac{d^2\psi(x)}{dx^2}+\frac{1}{2}m\omega^2x^2\psi(x)=E\psi(x)$$
    这个方程可以使用幂级数解法去解决, 我们先介绍一种比较物理的方法去求解, 即\uwave{升降阶算符法}。
    \subsection{代数方法}
    定态薛定谔方程的算子写法为$\hat{H}\psi=E\psi$, 代数方法的基本思路是去分解哈密顿算符:
    $$\hat{H}=\frac{1}{2m}\left[\hat{p}^2+(m\omega x)^2\right]$$
    如果是普通的复数$u^2+v^2$我们可以分解为$(u+iv)(u-iv)$, 这也就启发了我们像下面一样去定义升降阶算符, 前面多出来的$\frac{1}{\omega\hbar}$因子可以让
    后面的形式更加美观。
    \begin{define}{产生/湮灭算子}
        \begin{lequation}
            \hat{a}_\pm\overset{def}{=}\frac{1}{\sqrt{2m\omega\hbar}}(\mp i\hat{p}+m\omega x)
        \end{lequation}
    \end{define}
    \begin{thinknote}
        在计算算符时, 要格外小心, 算符一般情况下并不满足交换律, 你需要先将整个算符作用于一个函数上, 然后按照运算顺序逐个计算, 最后再进行化简。比如
        $x$和$\hat{p}$就不满足交换律\footnote[1]{量子力学很多与经典力学相冲突的地方就是因为这两个的不可交换性, 有的人将它当作公理去推导其它定理}, $
        x\hat{p}f(x)=-ix\hbar\frac{df}{dx}$但是$\hat{p}xf(x)=-i\hbar\frac{d}{dx}\left[xf(x)\right]=-i\hbar[f(x)+x\frac{df(x)}{dx}]$。
    \end{thinknote}
    \begin{define}{对易子}
        \begin{lequation}
            \left[\hat{A},\hat{B}\right]\overset{def}{=}\hat{A}\hat{B}-\hat{B}\hat{A}
        \end{lequation}
    \end{define}
    显然对易子是反对称的, 即$\left[\hat{A},\hat{B}\right]=-\left[\hat{B},\hat{A}\right]$, 计算可以得到下面很有用的关系式：
    \begin{lequation}
        \boxed{
            \left[x,\hat{p}\right]=i\hbar\qquad
            \left[\hat{a}_-,\hat{a}_+\right]=1
        }
    \end{lequation}
    第一个式子也常称作\textbf{正则对易关系}, 我们继续使用算子重写定态薛定谔方程:
    \begin{lequation}
        \boxed{
            \hat{H}=(\hat{a}_-\hat{a}_+-\frac{1}{2})\omega\hbar=(\hat{a}_+\hat{a}_-+\frac{1}{2})\omega\hbar
        }
    \end{lequation}
    \begin{lequation}
        \boxed{
            \omega\hbar(\hat{a}_+\hat{a}_-+\frac{1}{2})\psi(x)=E\psi(x)
        }
    \end{lequation}
    \begin{theorem}{谐振子的定态解}
        如果$\psi(x)$是谐振子在能量为$E$时的定态解, 那么$A\hat{a}_+\psi(x)$就是在能量为$E+\frac{1}{2}\omega\hbar$时的定态解\footnote[1]{前面乘上
        常数是归一化需要, 我们前面说过, 你求出来的解都需要进行归一化}, 同理, $A\hat{a}_-\psi(x)$是在能量为$E-\frac{1}{2}\omega\hbar$时的定态解。
    \end{theorem}
    直接根据湮灭和产生算子的定义可以很快地证明上述定理。现在很自然的就可以发现, 因为能量是不能一直递减的, 它至少要大于势能的最小值, 所以我们或许可以找到
    一个具有最低能量的定态解, 不能再使用湮灭算子产生新的解, 这个解我们称为$\psi_0(x)$, 是基态解。构造这个解的思路就是它的下一级是没有物理意义, 不能归一化的。
    也就是说有条件$$\hat{a}_-\psi_0(x)=0$$使用这个条件就可以得到基态解(不要忘了归一化)以及激发态解:
    \begin{lequation}
        \boxed{
            \psi_0(x)=\left(\frac{m\omega}{\pi\hbar}\right)^{\frac{1}{4}}e^{-\frac{m \omega}{2\hbar}x^2}
        }
    \end{lequation}
    \begin{lequation}
        \boxed{
            \psi_n(x)=\frac{1}{\sqrt{n!}}\left(\hat{a}_+\right)^n\psi_0(x),E_n=\left(n+\frac{1}{2}\right)\omega \hbar
        }
    \end{lequation}

    前面由归一化条件所决定的系数可以使用递推关系来确定, 再次强调, $\hat{a}_+\psi_n(x)=c_n\psi_{n+1}(x)$, $c$要根据归一化去确定, 并不是说使用产生算符可以
    直接得到高一个能级的解, 前面还有一个归一化条件确定的待定系数。
    \begin{theorem}{$\hat{a}_-$与$\hat{a}_+$是厄密共轭的(相互为伴随算子)}
        \begin{lequation}
            \int f^*(\hat{a}_\pm g)dx=\int (\hat{a}_\mp f)^* gdx
        \end{lequation}
    \end{theorem}
    直接计算$\left \| \hat{a}_+\psi_n(x) \right \|$和$\left \| \hat{a}_-\psi_n(x) \right \|$, 并利用$\hat{a}_+\hat{a}_-\psi_n=n\psi_n$及$\hat{a}_-\hat{a}_+\psi_n=(n+1)\psi_n$
    可以确定递推关系前面的系数(老规矩, 归一化只能确定模长, 但是我们只取最简单的那个值)。
    \begin{lequation}
        \boxed{
            \hat{a}_+\psi_n=\sqrt[]{n+1}\psi_{n+1},\quad\hat{a}_-\psi_n=\sqrt[]{n}\psi_{n-1}
        }
    \end{lequation}

    使用算符去表达可以使得计算更加简便, 你可以很容易的验证这些定态解之间相互正交, 所以可以使用傅里叶方法(你要求哪个常数, 你就在初态前面乘上对应的定态解, 然后
    全空间内积分, $t\neq0$时要考虑一下wiggle-function项)去定系数。计算力学量平均值的时候也可以使用产生湮灭算符去重新描述$x$和$\hat{p}$简化运算:
    \begin{lequation}
        \boxed{
            x =\sqrt[]{\frac{\hbar}{2m\omega}}\left(\hat{a}_++\hat{a}_-\right), \quad 
            p =i\,\sqrt[]{\frac{\hbar m \omega}{2}}\left(\hat{a}_+-\hat{a}_-\right)
        }
    \end{lequation}

    下面画出前三个能级对应波函数的能量, 不难看出图像具有的规律性和一维无限深势阱相同。
    \begin{figure}[htbp]
        \centering
        \subfigure[$n=1$]{
            \includegraphics[scale=0.7]{fig/2-3-a.eps}
        }
        \subfigure[$n=2$]{
            \includegraphics[scale=0.7]{fig/2-3-b.eps}
        }   
        \subfigure[$n=3$]{
            \includegraphics[scale=0.7]{fig/2-3-c.eps}
        }   
        \caption{可以看到, 图像之间的递推联系还是满足前面的规则的}
    \end{figure}
    \subsection{分析方法}
    \begin{define}{两个无量纲数}
        \begin{center}
            \begin{math}
            \displaystyle
            \xi = \sqrt{\frac{m\omega}{\hbar}}x \qquad\qquad K=\frac{2E}{\omega\hbar}
            \end{math}
        \end{center}
    \end{define}
    重写方程为:
    \begin{lequation}
        \label{rewrite}
        \frac{d^2\psi}{d\xi^2}=(\xi^2-K)\psi
    \end{lequation}
    \begin{thinknote}
        你可能对这个形式的得到有所疑问, 实际上, 这就是一个求导的链式法则的问题, 注意, 换元前的方程$\frac{d\psi}{dx}$表示把$\psi$写成$f(x)$后再求导, 而
        换元后的方程中$\frac{d\psi}{d\xi}$表示将$\psi$表示为$\phi(\xi)$后再进行求导。而$\xi=\varphi(x)$, 使用链式法则便可以理解这里的换元了。
    \end{thinknote}
    使用幂级数方法求解的第一步就是去求其\uwave{渐进解}, 也就是说去观察$\xi \to \pm\infty$的时候方程的行为。这个方程在$\xi\gg K$时
    $$\frac{d^2\psi}{d\xi^2}\approx\xi^2\psi$$这个方程的通解形式是$$\psi\approx Ae^{-\xi^2/2}+Be^{\xi^2/2}$$显然$B\neq 0$时波函数不能进行归一化, 所
    以, 方程\ref{rewrite}的解的形式应该是$\psi = h(\xi)e^{-\xi^2/2}$, 代入后有$$\frac{d^2h}{d\xi^2}-2\xi\frac{dh}{d\xi}+(K-1)h=0$$这是一个二阶方程
    但是是变系数, 所以也很难求解, 只能考虑使用幂级数解法, 两边进行Taylor展开后解得$$h(\xi)=\sum_{j=0}^\infty a_j\xi^j,\qquad a_{j+2}=\frac{2j+1-K}{(j+1)(j+2)}a_j$$
    我们只要确定$a_0$和$a_1$也就可以确定解, 二阶方程刚好两个待定系数, 但是我们只有波函数归一化这一个方程似乎无法去完整的确定两个待定系数。这里的原因是能量
    的量子化取值, 导致了最后方程只会含有一个待定系数。

    我们可以证明, $h(\xi)$只能在某些特定的情况下在$\xi \to \pm \infty$时收敛, 这也就决定了\textbf{$K$的取值是量子化的}。事实上, 收敛的充要条件是, 上面的数列$\{a_j\}$
    会终止于$0$。
    \begin{proposition}{$a_j$会终止于$0$}
        \begin{center}
            \begin{math}
            \displaystyle
            K=2n+1,\quad (n=0,1,2,\ldots)
            \end{math}
        \end{center}
        如果$n$是奇数, 那么$a_{2n+1}$会终止于$0$, 但是$a_0=0$也就是说必须有$a_{2n}\equiv 0$, $n$为偶数时类似
    \end{proposition}
    这样方程最终得到的解就只会有一个待定系数了, 而且由递推公式得知是正比于$a_0$或$a_1$的, 再利用归一化条件便可以得到解
    \begin{define}{厄米多项式}
        把$h(\xi)$的$a_0$或者$a_1$因子去掉并且乘上一个数将最高次项前面的因子化为$2^n$, 得到的多项式为\textbf{厄米多项式}, 记作$H_n(\xi)$\\
        例如:$h_2(\xi)=a_0(1-2\xi^2)=-\frac{1}{2}a_0(4\xi^2-2)$则$H_2(\xi)=4\xi^2-2$
    \end{define}
    我们不加证明地列出波函数归一化后的解与厄米多项式之间的关系\footnote[1]{前面因子的相位按照惯例按最简单的取}:
    \begin{lequation}
        \boxed{
            \psi(x)=\left(\frac{m\omega}{\pi\hbar}\right)^{\frac{1}{4}}\frac{1}{\sqrt{2^nn!}}H_n(\xi)e^{-\xi^2/2}
        }
    \end{lequation}
    \begin{theorem}{$H_n(\xi)$的诸多性质}
        \begin{itemize}
            \item 
                \begin{math}
                    \displaystyle
                    H_n(\xi)=(-1)^ne^{\xi^2}\left(\frac{d}{d\xi}\right)^ne^{-\xi^2}
                \end{math}
            \item 
                \begin{math}
                    \displaystyle
                    H_{n+1}(\xi)=2\xi H_n(\xi)-2nH_{n-1}(\xi)
                \end{math}
            \item 
                \begin{math}
                    \displaystyle
                    \frac{d H_n}{d\xi}=2n H_{n-1}(\xi)
                \end{math}
            \item 
                \begin{math}
                    \displaystyle
                    e^{-z^2+2z\xi}=\sum_{n=0}^{\infty}\frac{z^n}{n!}H_n(\xi)\quad\text{(generate function)}
                \end{math}
        \end{itemize}
    \end{theorem}
    量子效应下, 谐振子的行为和经典力学非常不同, 不再有\uwave{振幅}这一概念, 粒子可以在无穷远处被发现, 不违背能量守恒定律正是因为量子力学中, 我们只谈系综的
    力学量的平均值, 不再对于某个粒子有诸如动能这些的定义了, 我们只讲系综的平均效应, 只谈概率, 不谈确定性。
    \section{自由粒子}
    自由粒子情况下即$V \equiv 0$, 不难发现定态薛定谔方程和无限深势阱的形式是一样的, 即$$\frac{d^2\psi}{dx^2}=-k^2\psi$$解的形式为$$Ae^{ikx}+Be^{-ikx}$$
    注意, \uwave{我们不再有边界条件去直接确定$A$和$B$的值}, \textbf{这个时候定态解的能量的取值并不是离散的!可以取到任何大于$0$的值!}其实本身量子力学就是不排斥
    连续性的, 离散可以有很多种, 不一定就表明某个量一定是离散取值。

    考虑wiggle-function后写成下面的形式\footnote[1]{这里$\psi_k$无法进行归一化, 不像前面一样我们先进行归一化后再去定系数会有很多便利。但是这里我们还是在
    前面添了一个$\frac{1}{\sqrt{2\pi}}$你很快就可以看见他在数学处理上的妙处}:
    \begin{lequation}
        \boxed{
            \Psi_k(x,t)=Ae^{i\left(kx-\frac{k^2\hbar t}{2m}\right)}, \psi(x)=\frac{1}{\sqrt{2\pi}}e^{ikx}
        }
    \end{lequation}
    考虑到最后反正要对解进行线性叠加, 而两项仅仅只在$e$指数上面差了一个负号, 所以我们将负号纳入$k$后得到:
    $$k\overset{def}{=}\pm\frac{\sqrt{2mE}}{\hbar}$$观察到每一项就代表一个\uwave{行波}, $k>0$的时候正向传播(向右), 反之负向传播, 不再是前面势阱模型里面的
    驻波。
    \begin{thinknote}
        对于某个确定的振幅对应了一个$x$, 也就是说概率波上面的某一个确定的点, 其$x$和$t$之间满足$x\pm vt=\text{const}$的演化关系, 也即$x=\mp v +\text{const}$。所以可以认为概率
        波上的每个点都以$v$的速度在\uwave{平移运动}, 也很容易根据速度前的正负号确定是左行波还是右行波了。顺带一提, 这种形式下的行波, 模长平方(概率密度)与位置
        无关(不同位置找到粒子概率都一样), 都等于指数项前面振幅的平方, 这也是后面$\delta$势阱散射态求透射系数的基础。
    \end{thinknote}
    
    与经典力学中的波动方程相对应, 前面讲过$k$可以理解为角波数, 那么波速$v=\frac{|k|\hbar}{2m}=\sqrt{\frac{E}{2m}}$, 角频率$\omega=\frac{k^2\hbar}{2m}$, 过会我们会再回到波速的问题上来, 目前
    来看似乎有自由粒子速度$v_p=\sqrt{\frac{2E}{m}}=2v_{wave}$。

    自由粒子的波函数的定态解与前面两个模型最大的不同就是\textbf{它是无法归一化的}。所以现在我们求出来的定态解完全只是数学上的一个过程\footnote[1]{虽然不存在这样一个定态, 但是我们前面介绍的解薛定谔方程的一般手段仍旧不变, 只是这些“定态”不可归一化且是连续谱}, 没有实际的物理意义
    不存在一个状态, 其中自由粒子属于能量始终不变的定态(无论如何测量都是一个值)。但是没事, 虽然不存在定态, 但是我们还是可以使用定态解的线性组合来构造符合初值的
    解\footnote[2]{这些合成的解沿用波动学的观点, 称为\uwave{波包}, 是可归一化的}, 这些“定态”解也是归一化和完备的。

    我们仍旧对定态解进行线性叠加, 注意是对定态解叠加, 也就是对定态解的波函数进行叠加不是$\psi$而是$\Psi$, 所以不要忘记了每个$\psi$后面的关于时间的指数项。
    \begin{lequation}
        \label{2.26}
        \boxed{
            \Psi=\int_{-\infty}^{\infty}\phi(k)\psi_ke^{-\frac{ik^2\hbar}{2m}t}dk=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}\phi(k)e^{i\left(kx-\frac{k^2\hbar}{2m}t\right)}dk  
        }
    \end{lequation}
    和\ref{find_c}对比一下就会发现, $\phi(k)$取代了$c_n$, 这一点很好理解, 因为$\phi_k(x)$变成了一个关于$k$的连续函数, 而数列我们也通常称为\uwave{整标函数}, 所
    以, 前面变成连续函数来加权, 求和也变成了积分。

    初始值还是在$t=0$处给定\footnote[3]{若不是, 你对$t$进行一个换元平移一下计时零点即可}, 那么可以得到:
    \begin{lequation}
        \Psi(x,0)=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}\phi(k)e^{ikx}dk  
    \end{lequation}
    数学上$\Psi$就是对$\phi$的\uwave{傅里叶逆变换}, 下面的定理可以很方便的求出$\phi(k)$。
    \begin{theorem}{Plancherel's theorem}
        \begin{center}
            \begin{math}
                \displaystyle
                f(x)=\frac{1}{\sqrt{2\pi}} \int\limits_{-\infty}^{\infty}F(k)e^{ikx}dk\Longleftrightarrow F(k)=\frac{1}{\sqrt{2\pi}} \int\limits_{-\infty}^{\infty}f(x)e^{-ikx}dx
            \end{math}
        \end{center}
    \end{theorem}

    其中$F(x)$表示$f(x)$的傅里叶变换, 反之即为逆变换。
    \begin{lequation}
        \boxed{
            \phi(k)=\frac{1}{\sqrt{2\pi}} \int _{-\infty}^{\infty}\Psi(x,0)e^{-ikx}dx
        }
    \end{lequation}
    
    遗憾的是, 很多函数都只能写出积分后进行数值模拟, 无法用基本初等函数表示。
    \begin{define}{群速度和相速度}
        \begin{itemize}
            \item \textbf{群速度}：波包的移动速度
            \item \textbf{相速度}：波包里面有很多小峰, 这些小峰的移动速度便是相速度, 可以理解为一个在波上的质点跟随波的平移速度
        \end{itemize}
    \end{define}
    \animategraphics[scale=0.75,autoplay=True,loop]{24}{videos/wave_group/wave_group-}{0}{250}
    \begin{center}
        上面的动画中, {\color{red}红色}表示相速度, {\color{green}绿色}表示群速度
    \end{center}
    
    关于群速度和相速度的讨论应该是波动学的内容, 这里我们不想讨论过多, 只是先说明两个速度的计算公式, 在波包很明显也就是有很好的群速度的定义的时候, 单单从
    自由粒子的波动方程可以推出下面这一点。
    \begin{theorem}{群速度和相速度的计算}
        \begin{lequation}
            \boxed{
               v_g=\frac{d\omega}{dk}\qquad\qquad v_p=\frac{\omega}{k} 
            }
        \end{lequation}
    \end{theorem}
    其中, 波包是由一系列定态解叠加而成的, 具有下面的形式(对比\ref{2.26}):
    $$\Psi=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}\phi(k)e^{i\left(kx-\omega t\right)}dk,\quad \omega=\frac{k^2\hbar}{2m}$$
    正是由于多列行波的叠加才形成了波包, 而每个分量(行波)中的频率又是和$k$相关的, 这样就会导致群速度不等于相速度, 这时我们称之为\textbf{色散}, 自由粒子的
    波函数恰好就是多列行波的叠加, $\omega$是关于$k$的二次式, 那么, 代表粒子的群速度是代表行波前进的相速度的两倍这一论断就不难看出了。
    \section{\texorpdfstring{$\delta$}.函数势阱}
    \subsection{束缚态和散射态}
    最好引入束缚态和散射态的方法是使用经典类比, 我们前面提到的谐振子和无限深势阱都是束缚态, 他们每个定态解是可归一化的, 而且是分立谱, 粒子的行为像驻波一
    般, 会因为某些特定的边界条件使得波函数被限制在一个局域内。但是后面讲的自由粒子是连续谱, 不存在定态, 定态解不可归一化, 它的行为更像是一种行波, 可以自
    由延伸到无穷远处, 但是由定态解的线性组合构成的波包是可以归一化的, 这也就意味着, 一旦我们讨论的是自由粒子这种散射态, 他一定是很多种
    定态能量的叠加态, 不可能是测量后只会出现一种能量的某个定态, 一定是很多很多定态的组合, 因为对于散射态定态解是没有物理意义的, 这一点我们后面会再次提到。

    从经典力学来看, 由于物体的动能始终是一个定值, 所以在势能图上, 粒子永远不可能达到势能大于粒子总能量的地方(能量守恒), 从图上来看就是粒子被限制在两个点
    之间来回折返(\ref{turning_point}), 除非物体的能量大于势能的最大值, 这样粒子就会越过“山峰”, 不断前进。
    \begin{figure}[htbp]
        \centering
        \label{turning_point}
        \includegraphics[scale=0.5]{fig/2-5-1.eps}
        \caption{经典力学中, 粒子会被“困在”$x=a$和$x=b$之间}
    \end{figure}
    还是以上面的图像为例, 在经典力学看来(如果初始位置在$ab$之间的话), 这个图像会产生一个束缚态, 在量子力学中, 马上你将会看到, 由于所谓的\textbf{量子隧穿效应}
    , 任何有限高的势能都不能阻挡粒子, 粒子完全可以越过最高点大于其总能量的“山峰”。所以上面的图像对于量子理论来说也是一个散射态, 只有像前面所说的无限深势阱和
    谐振子, 才会导致粒子的束缚态的产生。
    \begin{theorem}{束缚态和散射态的判定准则}
        \begin{center}
            \begin{math}
                \displaystyle
                \begin{cases}
                    E>V(+\infty) \vee E>V(-\infty) \Rightarrow \text{Bound State}\\
                    E<V(+\infty) \wedge E<V(-\infty) \Rightarrow \text{Scattering State}
                \end{cases}
            \end{math}
        \end{center}
        一般情况下, $V(x)$会在$x\to\pm\infty$时趋近于$0$(谐振子和无限深势阱就是特例), 这个时候可以再次简化判定准则为:
        \begin{center}
            \begin{math}
                \displaystyle
                \begin{cases}
                    E>0 \Rightarrow \text{Bound State}\\
                    E<0 \Rightarrow \text{Scattering State}
                \end{cases}
            \end{math}
        \end{center}
    \end{theorem}
    注意, 我们前面在求解薛定谔方程时, 都说过$E>V_{min}$, 很遗憾, 这个条件在散射态时, 不起作用, 因为散射态我们并不严格要求定态解一定是可归一化的, 所以这
    个条件只能对于束缚态使用, 前面我们对谐振子和无限深势阱使用这个条件是完全正确的, 因为无论$E$是大于$0$还是小于$0$, 这两个势阱产生的都是束缚态, 那么束缚
    态的定态解必须是可归一化的, 这也就间接要求了$E$的非负性。事实上, 你如果在$E<0$的假定下求解这两种模型的解, 你会发现无论是定态还是线性组合后的解都是不可归一化的
    , 没有实在的物理意义。 在这个时候我们就说$E>0$的解已经构成了一个\uwave{完备集}, 初始的波函数一定是可以归一化的, 也一定是可以由对应的定态解组合而成, 然而
    $E<0$的解都不可以归一化, 所以这两种势能模型中仅当粒子$E>0$时有物理意义, 这一点实际上根据经典力学我们可以很容易类比得出。

    \subsection{\texorpdfstring{$\delta$}d函数势阱}
    注意这里我们讨论的是\uwave{势阱}, 主要是为了和后面的\uwave{势垒}区分, 你可以将势阱想象成一口井, 但势垒是一座山。
    \subsubsection*{狄拉克$\delta$函数}
    这个函数的定义你可以立即为将克罗内克符号扩充为一个连续函数, 也可以理解为是以个函数序列的极限。
    \begin{define}{$\delta$ function}
        \begin{center}
            \begin{math}
                \displaystyle
                \delta(x)\equiv
                \begin{cases}
                    0, x\neq 0\\
                    +\infty,x=0
                \end{cases},\text{but}\int_{-\infty}^{+\infty}\delta(x) dx=\int_{0^-}^{0^+}\delta(x) dx=1
            \end{math}
        \end{center}
    \end{define}
    \begin{proposition}{$\delta$函数的提取性质}
        \begin{itemize}
            \item $f(x)\delta(x-a)=f(a)$
            \item $\int_{-\infty}^{\infty}f(x)\delta(x-a)=f(a)$
        \end{itemize}
    \end{proposition}
    我们现在考虑的势阱形式是$V(x)=-\alpha\delta(x),\alpha>0$。显然, $E>0$时是散射态, $E<0$时是束缚态\footnote[1]{考虑束缚态时, 除了根据判据, 你还要
    观察下, 在这个能量条件下, 定态解是不是平方可积的, 满足束缚态的定义, 在这里由于$V_{min}\to -\infty$, 所以恒有$E>V_{min}$, 粗略来看束缚态是可以在这个
    能量条件下给出的, 后面的势垒就是个反例。}。
    \subsubsection*{束缚态($E<0$)}
    定态薛定谔方程:
    \begin{center}
        \begin{math}
            \displaystyle
            -\frac{\hbar^2}{2m}\frac{d^2\psi}{dx^2}-\alpha\delta(x)\psi=E\psi
        \end{math}
    \end{center}
    定义$\kappa\equiv\frac{\sqrt{-2mE}}{\hbar}$, 这个解应该是一个分段函数形式, 分段求解首先考虑$x<0$, 方程可以写成:
    $$\frac{d^2\psi}{dx^2}=\kappa^2\psi$$方程的通解具有形式$\psi(x)=Ae^{\kappa x}+Be^{-\kappa x}$, 实际上对于波函数, 我们有下面的必要边界条件\footnote[1]{实际上是量子力学几条基本原理之一}:
    \begin{proposition}{$\psi$标准条件}
        \begin{itemize}
            \item \textbf{连续性}: $\psi(x)$是一个连续函数
            \item \textbf{一阶导数连续性}: 除了$\delta(x)$这样的奇异函数$\frac{d\psi}{dx}$具有连续性
            \item \textbf{单值性}: 显然一个点只能对应一个概率密度
            \item \textbf{有界性}: $x\to\pm\infty$时, $\psi(x)$不能趋近于无穷大
            \item \textbf{归一化条件}: 当然现在我们\uwave{只能对束缚态这么做了}, 可以用这个定出每个定态前的系数
        \end{itemize}
    \end{proposition}
    利用有界性我们直接推出$A=0$, $x>0$时, 同样分析可以得出$\psi(x)=Fe^{\kappa x}+Ge^{-\kappa x}$, 其中$F=0$。另外, 利用在$x=0$处的连续性可以得到$B=G$
    , 但是在$x=0$处一阶导\uwave{并不连续}, 我们对定态方程两边积分可以得到$$\frac{\hbar^2}{2m}\left[\psi'_+(0)-\psi'_-(0)\right]+\alpha\psi(0)=0$$
    然后再代入$\psi'_+(0)-\psi'_-(0)=-2\kappa B$并进行归一化后不难得到
    \begin{lequation}
        \boxed{
            \psi(x)=\frac{\sqrt{m\alpha}}{\hbar}e^{-m\alpha\left|x\right|/\hbar^2}, \qquad E=-\frac{m\alpha^2}{2\hbar^2}
        }
    \end{lequation}
    
    通常的束缚态都有无穷多个定态, 但是这个问题却出奇的单调, 只有一个定态, 只有一种能量的可取值。
    \begin{figure}[htbp]
        \centering
        \includegraphics[scale=0.5]{fig/2-5-2.eps}
        \caption{这是束缚态$\psi$图像, 不是概率密度曲线}
    \end{figure}
    \subsubsection*{散射态($E>0$)}
    散射态比较难以处理, 我们还是分段考虑我们可以得到下面的解:
    \begin{center}
        \begin{math}
            \displaystyle
            \psi(x)=
            \begin{cases}
                Ae^{ikx}+Be^{-ikx},x<0\\
                Fe^{ikx}+Ge^{-ikx},x<0
            \end{cases}
            ,k=\frac{\sqrt{2mE}}{\hbar}
        \end{math}
    \end{center}
    遗憾的是, 这次我们不能通过有界性指出哪一项前面的系数一定为$0$了, 散射态最明显的性质就是\textbf{$\psi$在无穷远处不会趋近于$0$, 也就是说不像束缚态
    的驻波性质一般被局限在某个范围内}, 它更像是在描述一个粒子从无穷远处来, 过散射中心后到无穷远处去, 所以被称作\uwave{散射态}。

    不过好在波函数的连续性还在, 我们还是可以通过对方程两边积分得到导数的跃变关系, 同束缚态一样, 我们得到:
    $$A+B=F+G$$ $$F-G=(1+2i\beta)A-(1-2i\beta)B$$其中$\beta\equiv\frac{m\alpha}{k\hbar^2}$。这是一个不定方程, 我们还缺少初始波函数条件, 虽然这样的定态是
    不存在的, 只有它们合成的波包才有意义, 但是不妨碍我们去考察一下这个解背后蕴含的思想, 实际上和光学上的反射和透射非常相似。
    
    之前我们求解自由粒子的波函数的时候发现, 考虑了含时指数因子后, $\Psi_k(x,t)=A\exp\left[i\left(kx-\frac{k^2\hbar}{2m}t\right)\right]$在$k>0$时表示
    向右传播的行波, 反之表示向左传播的行波。结合这个问题, 考虑的解的区间, 这个解可以看作是
    \begin{itemize}
        \item $x<0$,$-\infty\to0$的振幅为$A$的波和$0\to-\infty$的振幅为$B$的波;
        \item $x>0$,$+\infty\to0$的振幅为$G$的波和$0\to+\infty$的振幅为$G$的波。
    \end{itemize}
    我们考虑比较简单的情况即$G=0$, 也就是说粒子从左边入射, 然后在$x=0$处就如有一个介质一般, 粒子的入射波一部分被反射($B$)一部分透射($F$)
    \begin{lequation}
        F=\frac{1}{1-i\beta}A,\quad B=\frac{i\beta}{1-i\beta}A
    \end{lequation}
    我们还可以同光学一样, 讨论相对于原先的入射波, 透射波和反射波损失了多少, 即透射系数($T$)和反射系数($R$):
    \begin{lequation}
        \begin{aligned}
            &R\equiv\frac{|B|^2}{|A|^2}=\frac{\beta^2}{1+\beta^2}\\
            &T\equiv\frac{|F|^2}{|A|^2}=\frac{1}{1+\beta^2}\\
            &R+T=1
        \end{aligned}
    \end{lequation}

    我们再将其写成能量的关系式:
    \begin{lequation}
        \boxed{
            R=\frac{1}{1+\left(2\hbar^2E/m\alpha^2\right)}, T=\frac{1}{1+\left(m\alpha^2/2\hbar^2E\right)}
        }
    \end{lequation}

    能量越高透射波的振幅越大, 也就是说粒子\uwave{穿过}势阱的可能性越高, 这显然是与常识相符的。

    当然, 由于定态解合成的波包才是真正有物理意义的解, 所以我们推出来的$R$和$T$应当理解成粒子的能量在某一个很小的范围的时候的近似值\footnote[1]{前面提到过需要多个态叠加
    才有物理意义, 这也就意味着粒子测量时的能量一定是在某个连续的范围内, 散射态的能量本征值是连续谱。}
    \subsubsection*{$\delta$函数势垒}
    形式上来看势垒的解形式上应该和上面讨论的势阱的散射态相同, 只是$\alpha$的符号刚好相反。但是透射系数和反射系数是不变的。
    \begin{thinknote}
        注意, 这个时候是不存在束缚态的, 你可以这么想, 如果存在束缚态, 那么束缚态的定态一定可归一化, 那么$E>V_{min}=0$, 但是根据判定条件, 或者解方程可以明显
        的发现$E>0$的时候是一个散射态, 就如谐振子和自由粒子一样, $E>0$的解构成了一个完备集。
    \end{thinknote}
    那么既然透射系数不一定为$0$, 也就是说, 和经典情况不同, 经典力学中, 粒子不可能穿过$\delta$势垒, 但是量子散射效应下, 粒子完全有概率穿过势垒, 而且与其
    携带的能量正相关, 这种现象称之为\textbf{量子隧穿效应}, 在电子显微镜及其它很多领域中有广泛的应用。
    \subsubsection*{$\delta$函数势阱束缚态计算}
    我们之前讲的计算方法就是利用连续性和薛定谔方程两端积分, 这对于只有一个$\delta$函数的势阱很实用, 但是$\delta$函数数目较多时, 由于还要分段求解方程, 计算就显得比较繁琐了, 下面介绍一种
    利用傅里叶变换快速计算的方法\footnote[2]{cf.顾樵, 量子力学, vol.1, P140-144}。

    傅里叶变换使用如下定义方法:
    \begin{equation}
        \label{傅里叶变换}
        \begin{aligned}
        \mathscr{F}[f(t)] &=F(\omega)=\int_{-\infty}^{+\infty} f(t) e^{-i \omega t} d t \\
        \mathscr{F}^{-1}[F(\omega)] &=f(t)=\frac{1}{2 \pi} \int_{-\infty}^{+\infty} F(\omega) e^{i \omega t} d \omega
        \end{aligned}
    \end{equation}
    \begin{proposition}{傅里叶变换常用性质}
        \begin{itemize}
            \item \textbf{线性性}\footnote[1]{使用$\mathscr{F}$表示变换, 大写字母表示变换后相应的函数}:$$
            \begin{gathered}
            \mathscr{F}[\alpha f(t)+\beta g(t)]=\alpha F(\omega)+\beta G(\omega) \\
            \mathscr{F}^{-1}[\alpha F(\omega)+\beta G(\omega)]=\alpha f(t)+\beta g(t)
            \end{gathered}$$
            \item \textbf{位移性}:$$
            \begin{gathered}
            \mathscr{F}\left[f\left(t-t_{0}\right)\right]=e^{-i \omega t_{0}} F(\omega) \\
            \mathscr{F}^{-1}\left[F\left(\omega-\omega_{0}\right)\right]=e^{i \omega_{0} t} f(t)
            \end{gathered}
            $$
            \item \textbf{放缩性}:$$
            \mathscr{F}[f(a t)]=\frac{1}{|a|} F\left(\frac{\omega}{a}\right)
            $$
            \item \textbf{对称性}:$$
            \mathscr{F}[F(t)]=2 \pi f(-\omega)
            $$
            \item \textbf{微分关系}:$$
            \begin{gathered}
            \mathscr{F}\left[\frac{d^{n} f(t)}{d t^{n}}\right]=(i \omega)^{n} F(\omega) \\
            \mathscr{F}^{-1}\left[\frac{d^{n} F(\omega)}{d \omega^{n}}\right]=(-i t)^{n} f(t)
            \end{gathered}$$
            \item \textbf{积分关系}:$$\mathscr{F}\left[\int f(t)dt\right]=\frac{1}{i\omega}F(\omega)$$
            \item \textbf{帕萨瓦尔定理}:$$
            \int_{-\infty}^{+\infty} f(t) g^*(t) d t=\frac{1}{2 \pi} \int_{-\infty}^{+\infty} F(\omega) G^*(\omega) d \omega
            $$
            \item \textbf{时域卷积定理}:$$
            \mathscr{F}[f(t) * g(t)]=F(\omega) G(\omega)
            $$
            \item \textbf{频域卷积定理}:$$
            \mathscr{F}[f(t) g(t)]=\frac{1}{2 \pi} F(\omega) * G(\omega)
            $$
            \item \textbf{与$\delta$函数关系}:$$\delta(x)=\mathscr{F}^{-1}[1](x)$$
        \end{itemize}
    \end{proposition}

    我们下面以双$\delta$势阱为例来讲解这种方法。
    \begin{define}{双$\delta$势阱}
        \begin{equation}
            V(x)=-\alpha\left[\delta(x-a)+\delta(x+a)\right]
        \end{equation}
    \end{define}
    定态薛定谔方程写为:
    \begin{equation}
        -\frac{\hbar^2}{2m}\frac{d^2\psi}{dx^2}-\alpha\left[\delta(x-a)+\delta(x+a)\right]\psi=E\psi
    \end{equation}
    方程两边进行傅里叶变换(\ref{傅里叶变换}), $k$的定义同前, 有:
    \begin{equation}
        \begin{aligned}
        -\omega^2\mathscr{P}(\omega)-k^2\mathscr{P}(\omega)&=-\frac{2m\alpha}{\hbar^2}\int_{-\infty}^{\infty}\left[\delta(x-a)+\delta(x+a)\right]\psi(x)e^{-i\omega x}dx\\
        &=-\frac{2m\alpha}{\hbar^2}\left(e^{i\omega a}\psi(-a)+e^{-i\omega a}\psi(a)\right)
        \end{aligned}
    \end{equation}
    其中$\mathscr{F}\left[\psi(x)\right](\omega)\equiv\mathscr{P}(\omega)$, 解得:
    \begin{equation}
        \mathscr{P}(\omega)=\frac{2m\alpha}{\left(k^2+\omega^2\right)\hbar^2}\left(e^{i\omega a}\psi(-a)+e^{-i\omega a}\psi(a)\right)
    \end{equation}
    再进行傅里叶逆变换得到:
    \begin{equation}
        \psi(x)= \frac{m\alpha}{k\hbar^2}\left[\psi(a)e^{-k|x-a|}+\psi(-a)e^{-k|x+a|}\right]
    \end{equation}
    上式中, 我们取$x=-a$和$x=a$得到:
    \begin{equation}
        \begin{pmatrix}
            \frac{m\alpha}{k\hbar^2}-1&\frac{m\alpha}{k\hbar^2}e^{-2ka}\\
            \frac{m\alpha}{k\hbar^2}e^{-2ka}&\frac{m\alpha}{k\hbar^2}-1
        \end{pmatrix}
        \begin{pmatrix}
            \psi(a)\\
            \psi(-a)
        \end{pmatrix}
        =\begin{pmatrix}
            0\\0
        \end{pmatrix}
    \end{equation}
    这个方程显然必须要有非零解, 倘若只有平凡解, 则$\psi(x)\equiv0$, 显然不能归一化。对于非零解, 最终定态解的系数由归一化条件确定。
    \begin{equation}
        \Delta=\begin{vmatrix}
            \frac{m\alpha}{k\hbar^2}-1&\frac{m\alpha}{k\hbar^2}e^{-2ka}\\
            \frac{m\alpha}{k\hbar^2}e^{-2ka}&\frac{m\alpha}{k\hbar^2}-1
        \end{vmatrix}=0
        \Rightarrow e^{-2ka}=\pm\left(1-\frac{k\hbar^2}{m\alpha}\right)
    \end{equation}
    上式给出的是一个超越方程, 我们对它进行如下变形:
    \begin{equation}
        \left.\begin{matrix} 
           X\equiv 2ka=\frac{2a\sqrt{-2mE}}{\hbar}\\
            \sigma\equiv\frac{\hbar^2}{2ma\alpha}\\
            y^\pm(x) \equiv 1-\sigma X
          \end{matrix}\right\}\Rightarrow Y(X)=y^\pm(x)
    \end{equation}
    绘图后可以发现$\sigma<1$时图像有两个交点, $\sigma\geq 1$时图像只有一个交点, 而交点的个数就代表着能量的可取值, 一个交点对应了一个束缚态。
    \begin{center}  
        \animategraphics[scale=0.75,autoplay=True,loop]{8}{videos/equation_insection/equation_insection-}{0}{59}
    \end{center}
    \newpage
    \section{有限深势阱}
    \begin{define}{有限深势阱}
        \begin{center}
            \begin{math}
                \displaystyle
                V(x)=\begin{cases}
                    -V_0,\quad &-a\leq x \leq a\\
                    0, &|x|>a
                \end{cases}
            \end{math}
        \end{center}
    \end{define}
    对于束缚态, 定义$k\equiv\frac{\sqrt{-2mE}}{\hbar}$, 对于散射态定义$k\equiv\frac{\sqrt{2mE}}{\hbar}$, 无论散射态还是束缚态, 统一定义
    $l=\frac{\sqrt{2m\left(E+V_0\right)}}{\hbar}$。
    \subsection*{束缚态($E<0$)}
    \subsubsection*{(\romannumeral1)$x<a$}
    这个范围内$V=0$, 利用$\psi(-\infty)=0$的边界条件可以得到解为:$$\psi(x)=Ae^{kx}$$
    \subsubsection*{(\romannumeral2)$-a\leq x\leq a$}
    这个范围内$V=-V_0$, 通解的指数形式为$Ce^{ilx}+De^{-ilx}$, 这种形式我们称之为\textbf{行波形式}, 主要是散射态用的多。还可以利用Euler公式写成三角
    形式为$C\cos (lx)+D\cos (lx)$, 这种我们一般称为\textbf{驻波形式解}。这两种表达方式是完全等价的, 其中两个任意常数在复数域中取值在这里我们采用第二种
    驻波形式, 后面的数学处理更加简便。我们有:$$\psi(x)=C\cos (lx)+D\cos (lx)$$
    \subsubsection*{(\romannumeral3)$x>a$}
    和第一个范围形式一样, 为:$$\psi(x)=Fe^{-kx}$$
    \subsubsection*{边界条件}
    利用$\psi(x)$和$\psi\prime(x)$的连续性可以列出四个方程, 再利用归一化条件便可以完全定下五个参数。这里我们使用了一阶导的连续性, 实际上, 只要势能的性质
    并不是像$\delta$函数这么坏, 这个条件都是成立的, 不成立时我们可以得到两侧导数之间的关系。

    其实, 我们可以使用对称性进一步简化我们的运算\footnote[1]{如果没有想到对称性, 直接根据方程组有非零解, 系数行列式为0, 也可以计算出能级, 只是最后波函数的形式有点不同。}, 在束缚态的求解中, 下面的陈述十分有效:
    \begin{proposition}{定态波函数的对称性}
        如果所给势能$V(x)$是一个\textbf{偶函数}, 那么$\psi(x)$\textbf{总可以取作偶函数或者奇函数}\footnote[1]{注意这里是\uwave{取作},意思是用奇函数和偶函数作为基底是完全等价的, 不是说$\psi$一定有奇偶性}, 分奇偶讨论后根据条件取舍就可以得到全部的解。
    \end{proposition}
    上面的定理告诉我们可以只关心那些有对称性的解, 计算结果等价。下面分类求解。
    
    首先讨论偶函数情况, 我们事先将$\psi(x)$在势阱内部的形式写成了驻波解形式, 这样我们就很容易根据对称性进一步得出$D=0$, 事实上, 实际问题求解中到底选择
    行波形式还是驻波形式就是要尽可能让其中的一个待定系数为$0$, 比如$\delta$势阱散射态中我们取行波形式, 一是为了突出问题的物理内涵, 二是可以直接去掉另一个
    方向入射的波。我们还得到了$A=F$这个关系。

    利用边界条件和方程解算后可以得到:$$k=l\tan(al)$$我们再一次得到了能量取值应满足的条件, 这又是一个超越方程需要数值求解。我们不去具体计算能量, 我们通过这个式子将波函数进行
    归一化处理, 仍旧最简单的选取系数的相位, 可以得到:
    \begin{equation}
        \psi(x)=\begin{cases}
            \frac{e^{ka}\cos(la)}{\sqrt{a+1/k}}e^{kx},&x<-a\\
            \frac{1}{\sqrt{a+1/k}}\cos(lx),&-a\leq x\leq 0\\
        \end{cases}
    \end{equation}
    利用$\psi(x)$是偶函数可以得到另一边的解。

    同理, 对于奇函数情况, 我们可以得到$A=-F$, $C=0$。解得:$$k=-l\cot (la)$$归一化得到:
    \begin{equation}
        \psi(x)=\begin{cases}
            \frac{e^{ka}\cos(la)}{\sqrt{a+2\cos^2(la)/k}}e^{kx},&x<-a\\
            \frac{1}{\sqrt{a+2\cos^2(la)/k}}\sin(lx),&-a\leq x\leq 0\\
        \end{cases}
    \end{equation}
    利用$\psi(x)$是奇函数可以得到另一边的解。

    值得注意的是, 上面的解在$V_0\to+\infty$, $a\to 0$是退化为$\delta $势阱模型的解; 在$V_0\to +\infty$, $a$保持为有限值时, 退化为无限深势阱的解, 只是宽度
    为$2a$能量的取值应写为$$E_n=\frac{n^2\pi^2\hbar^2}{2m(2a)^2},\quad(n=1,2,3\ldots)$$
    \subsection*{散射态$E>0$}
    散射态的求解和前面过程差不多, 只是对应微分方程解的形式变了一下, 即:
    \begin{equation}
        \psi(x)=\begin{cases}
            Ae^{ikx}+Be^{-ikx},&x<-a\\
            C\cos(lx)+D\sin(lx),&-a\leq x\leq a\\
            Fe^{ikx}+Ge^{-ikx},&x>a
        \end{cases}
    \end{equation}
    势阱外部我们写成行波形式, 是为了突出物理意义, 势阱内部写成驻波形式主要是为了表示方便。不失一般性, 我们还是假定只有从$-\infty$向右入射的粒子, 也就是
    说$G=0$, 再去求解透射系数和反射系数。

    同样利用波函数的连续性和一阶导数的连续性, 最后我们解得透射系数和反射系数(这需要花点时间):
    \begin{equation}
        \begin{aligned}
        &B=i \frac{\sin (2 l a)}{2 k l}\left(l^{2}-k^{2}\right) F \\
        &F=\frac{e^{-2 i k a} A}{\cos (2 l a)-i \frac{\left(k^{2}+l^{2}\right)}{2 k l} \sin (2 l a)}
        \end{aligned}
    \end{equation}
    令$T=1$, 解得$$E_n+V_0=\frac{n^2\pi^2\hbar^2}{2m(2a)^2}$$
    
    方程右边正好就是无限深势阱束缚态能量的取值。这个现象在量子理论还不成熟时首先在实验上被发
    现, 称为\textbf{Ramsauer-Townsend effect}。
    \newpage
    \section{习题分析}
    \subsection*{2.34(c)}
    之前我们计算透射率和反射率, 都是在透射后势能与入射时的势能相同时的情况, 光学上的类比就是界面两边是同种介质。但是对于这个题目, 显然, 阶跃型势阱, 虽然反射
    后还是和入射时势能情况相同, 但透射后就不一样了, 所以透射系数不能使用原先的方法进行计算, 需要引入概率流, 在之后会介绍其引入经过:
    \begin{define}{概率流密度}
        \begin{equation*}
            J\overset{def}{=}\frac{\mathrm{i} \hbar}{2 m}\left(\Psi \frac{\partial \Psi^{*}}{\partial x}-\Psi^{*} \frac{\partial \Psi}{\partial x}\right)\tag{1-D}
        \end{equation*}
        \begin{equation}
            J\overset{def}{=}\frac{\mathrm{i} \hbar}{2 m}\left(\Psi \frac{\nabla \Psi^{*}}{\partial x}-\Psi^{*} \frac{\nabla \Psi}{\partial x}\right)\tag{2-D}
        \end{equation}
    \end{define}
    计算反射率和透射率的时候就需要通过概率流密度来计算, 即:
    \begin{equation}
        R=\frac{|J_R|^2}{|J_I|^2},T=\frac{|J_T|^2}{|J_I|^2}
    \end{equation}
    前面的计算方式是上面的特例。
    \subsection*{2.36}
    这个题我想再次强调一下归一化只能得到解前面的系数的模方, 还有不确定的复数幅角, 所以得到的$\psi_n$前面的负号完全可以直接丢掉, 只要不改变前面归一化系数的
    模长, 就可以随便扔, 使得方程更加简洁。反正最后代入初始波函数的时候还要再确定一下系数。
    \subsection*{2.40}
    \begin{itemize}
        \item 给定了初始波函数之后, 由于波函数的演化必须连续的按照薛定谔方程进行(也就是说演化过程中解出来的$c_n$不会改变), 按照这个约束初始波函数前面系数相位给定后, 后面的也就都唯一确定了；
        \item 不一定要严格按照傅里叶方法去积分计算$c_n$, 有时候可以直接\uwave{猜出来}, 并且有利于后面的分析。
    \end{itemize}
    \subsection*{2.44}
    \begin{define}{简并性}
        如果定态薛定谔方程的两个\uwave{线性无关解}所对应的能量$E$相等, 那么就称这两个态是简并的。比如对于自由粒子波函数, $e^{ikx}$和$e^{-ikx}$都是能量为
        $\frac{k^2\hbar^2}{2m}$时的解。一个往右传播, 一个往左传播。
    \end{define}
    \begin{theorem}{束缚态的能级非简并性}
        对于\textbf{一维束缚态}, 除了2.45提及的情况, 只要$\lim\limits_{x\to\pm\infty}\psi(x)=0$, 那么一定有, 束缚态的能级没有简并性, 也就是说, 对于$E$的同一个取值, 波函数的
        解一定是线性相关的, 或者说归一化后只相差一个相位因子$e^{i\theta}$, 本质上是一个东西。
    \end{theorem}
    \subsection*{2.53 \& 2.54}
    这两个题目引入了\uwave{散射矩阵}和\uwave{转移矩阵}的概念, 重点在于说明了总的透射系数并不是两次透射系数直接相乘(本质在于两个势阱之间的部分向左向右
    的波都有)。
    \subsection*{2.59}
    通过这个题我们可以补充艾里函数(Airy function)的概念。

    艾里函数分为$\mathrm{Ai}(x)$和$\mathrm{Bi}(x)$, 它们是下面的艾里方程(又称斯托克斯方程)的两个线性无关解
    $$\frac{d^2y}{dx^2}-xy=0$$

    \begin{figure}[htbp]
        \centering
        \includegraphics[scale=0.85]{fig/2-7-1.eps}
        \caption{Airy function}
    \end{figure}
    注意到$\lim\limits_{x\to +\infty}\mathrm{Bi}(x)=+\infty$, 无法归一化, 所以量子力学中我们会舍去$\mathrm{Bi}(x)$。

    还可以利用反常积分直接定义艾里函数:
    \begin{equation*}
        \mathrm{Ai}(x)=\frac{1}{\pi}\int_{0}^{+\infty}\cos\left(\frac{t^3}{3}+xt\right)dt
    \end{equation*}
    \begin{equation*}
        \mathrm{Bi}(x)=\frac{1}{\pi}\int_{0}^{+\infty}\left[\exp\left(-\frac{t^3}{3}+xt\right)+\sin\left(\frac{t^3}{3}+xt\right)\right]dt
    \end{equation*}
    
    而且$\mathrm{Ai}(x)$是正交归一的, 这也印证了量子力学本征态之间的正交归一关系:
    \begin{equation*}
        \int_{-\infty}^{+\infty}\mathrm{Ai}(t+x)\mathrm{Ai}(t+x)\mathrm{d}t=\delta(x-y)
    \end{equation*}
    \chapter{形式化理论}
    \section{可观测量}
    虽然量子力学需要引入虚数, 但是实际上实验测得的量都是实数, 也就是说可观测量$Q$的测量值始终是实数。\footnote[1]{与书上顺序不同, 我假定已经看过附录B, 对狄拉克符号已经有所了解}
    \[Q = {Q^*} \Rightarrow \left\langle Q \right\rangle  = {\left\langle Q \right\rangle ^*}\]
    第一章我们就强调了, 计算某个量的平均值时, 把\textbf{这个量对应的算符}夹在波函数之间后积分即可\footnote[2]{其实更好的记号是狄拉克符号$\left\langle \Psi  \right|\hat Q\left| \Psi  \right\rangle $}：
    \[\left\langle Q \right\rangle  = \int {{\Psi ^*}\hat Q\Psi dx}  = \left\langle {\Psi }\mathrel{\left | {\vphantom {\Psi  {\hat Q\Psi }}}\right. \kern-\nulldelimiterspace}
    {{\hat Q\Psi }} \right\rangle ,{\left\langle Q \right\rangle ^*} = \left\langle {{\hat Q\Psi }}\mathrel{\left | {\vphantom {{\hat Q\Psi } \Psi }}\right. \kern-\nulldelimiterspace}
    {\Psi } \right\rangle \]
    利用算符的厄米共轭的定义, 可以发现:
    \begin{equation}
        \boxed{
            \hat{Q}^\dagger=\hat{Q}
        }
    \end{equation}
    也就是说：
    \begin{equation}
        \boxed{
            \text{每个可观测量都对应了一个厄米算符}
        }
    \end{equation}
    很容易验证$\hat{p}=id/dx,\hat{x}=x$都是厄米算符, 但是微分算符$\hat{D}\equiv\frac{d}{dx}$不是厄米算符, 我们还可以得到一个更强的结论:
    \begin{lequation}
        \begin{array}{c}
            \hat{D}^\dagger = -\hat{D} \\ 
            \left(\hat{D}^n\right)^\dagger\equiv\left[\frac{\rm{d}^n}{\rm{d}x^n} \right]^\dagger=\left(\hat{D}\hat{D}\cdots\hat{D}\right)^\dagger=(-1)^n\hat{D}^n
        \end{array}
    \end{lequation}

    量子力学与经典力学最大的不同就是当你对系综测量某个可观测量$Q$时, 测量结果会呈现一定的概率分布。那么, 能否对于某个可观测量找到对应的一个量子态$\left|Psi\right\rangle$, 当系综中所有的粒子均处于
    这个态时, 对这个系综测量$Q$那么得到的值失去了概率分布, 总是固定值(比方说$q$)?答案是肯定的, 而且我们将这种态称为\uwave{定值态}(不是前面定态波函数解的那个定态, 不过那个定态波函数的解, 确实是关于$\hat{H}$的定值态)。
    \begin{equation*}
        \left.\begin{matrix} 
            \left \langle Q \right \rangle=q \\ 
            \sigma^2=0
          \end{matrix}\right\}\Rightarrow \left \langle \left( Q-\left \langle Q \right \rangle  \right )^2\right \rangle  =0
    \end{equation*}
    利用前面求$\left\langle Q \right\rangle$的方法可以验证:
    \[\left \langle \left( Q-\left \langle Q \right \rangle  \right )^2\right \rangle =\left\langle {\Psi }
    \mathrel{\left | {\vphantom {\Psi  {{{\left( {\hat Q - q} \right)}^2}\Psi }}}
    \right. \kern-\nulldelimiterspace}
    {{{{\left( {\hat Q - q} \right)}^2}\Psi }} \right\rangle \]
    再注意到$q$为实数, $Q$为可观测量, 所以$\hat{Q}-q$是厄米算符, 所以
    \[\left\langle {{\left( {\hat Q - q} \right)\Psi }}
    \mathrel{\left | {\vphantom {{\left( {\hat Q - q} \right)\Psi } {\left( {\hat Q - q} \right)\Psi }}}
    \right. \kern-\nulldelimiterspace}
    {{\left( {\hat Q - q} \right)\Psi }} \right\rangle =0\Rightarrow
    \boxed{\hat{Q}\Psi=q\Psi}\]
    也就是说, 定值态是算符$\hat{Q}$的本征向量, 而对应的测量值就是本征值。\footnote[1]{更多这方面的内容, 请翻阅附录\ref{Appendix B}}

    比如定态薛定谔方程$$\hat{H}\psi=E\psi$$
    很好解释为什么定态解是关于哈密顿算符的定值态, 注意到波函数$\Psi(x,t)=\psi(x)e^{iEt/\hbar}$仍是$E$的特征向量, 所以定态波函数确实就是能量的定值态。\footnote[2]{或者说成比例的两个右矢表示的是同一个物理状态。}
    \section{观察算符和算符的谱}
    厄米算符的谱可能是离散谱(比如无限深势阱), 也可能是连续谱(比如自由粒子)。对于离散谱, 我们已经通过模型的计算大约了解到特征矢都是平方可积的, 但对于连续谱就不再成立。
    但是这些本征矢之间有些重要性质, 比如正交性, 完备性, 我们用标准的线性代数语言再来描述一下。注意, 我们讨论的范围一直是可观测量对应的厄米算符。
    \subsection*{离散谱}
    \begin{itemize}
        \item \textbf{本征值都是实数}
        \item \textbf{对应于不同本征值的本征矢相互正交}
    \end{itemize}
    \begin{thinknote}
        上面的两个性质都很容易证明, 我们证明第一个:
        \begin{align*}
            \hat{Q}|\psi\rangle  = \lambda|\psi\rangle &\Rightarrow\langle\psi|\hat{Q}| \psi\rangle = \lambda\langle\psi \mid \psi\rangle \Rightarrow\left\langle\psi\left|\hat{Q}^{\dagger}\right| \psi\right\rangle = \lambda^{*}\langle\psi \mid \psi\rangle\\
            &\Rightarrow \lambda =\lambda ^*\Leftrightarrow \lambda \in \mathbbm{R} 
        \end{align*}
    \end{thinknote}
    另外一个很重要的概念就是\textbf{完备性}。我们在算符$\hat{Q}$的本征值$\lambda_n$所对应的本征空间$g_n$中选取一组已正交归一化的基, 其中的第$i$个矢量标记为$\left|\psi_n^i\right\rangle$, 最后我们
    将这些基合起来, 根据前面的定理, 我们事实上已经选取了算符$\hat{Q}$的一个正交归一系:
    \begin{equation}
        \left\langle {{\psi _n^i}}
        \mathrel{\left | {\vphantom {{\psi _n^i} {\psi _{n'}^{i'}}}}
        \right. \kern-\nulldelimiterspace}
        {{\psi _{n'}^{i'}}} \right\rangle  = {\delta _{ii'}}{\delta _{nn'}}
    \end{equation}
    对于有限维向量空间, 根据\uwave{复谱定理}, 厄米算符$\hat{Q}$一定可对角化, $\mathscr{E}$一定可以写成$g_n$的直和形式, 上面确定的正交归一系一定是$\mathscr{E}$的一个基底。
    但是这个定理在无限维向量空间中并不能推广。
    \begin{define}{观察算符}
        对于厄米算符$\hat{Q}$, 如果$\mathscr{E}$可以使用它的一组本征矢作为基底, 也就是说\uwave{它的正交归一系满足}:
        \begin{equation}
            \sum\limits_{n = 1}^\infty  {\sum\limits_{i = 1}^{{g_n}} {\left| {\psi _n^i} \right\rangle \left\langle {\psi _n^i} \right|} }=\mathbbm{1}
        \end{equation}
        那么我们称$\hat{Q}$是观察算符, 这只是在离散基中的定义, 对于连续基, 定义类似, 后面再阐述。
    \end{define}
    我们现在对可观测量做一个更强的假定:
    \begin{equation*}
        \boxed{\text{\textbf{可观测量对应的实际上是观察算符}}}
    \end{equation*}
    \subsection*{连续谱}
    我们通过两个例子来说明这个问题, 实际上他们是重要的$\left | \bf{p}  \right \rangle$表象和$\left | \bf{r}  \right \rangle$表象。
    \begin{thinknote}
        \textbf{动量算符的本征值和本征矢}
        \begin{equation}
            -i\hbar\frac{d}{dx}f_p(x)=pf_p(x)
        \end{equation}
        分离变量解方程得:
        \begin{equation}
            f_p(x)=Ae^{\frac{ipx}{\hbar}}\notin\mathscr{E},p\in\mathbbm{F}
        \end{equation}
        我们现在只关注本征值为实数对应的本征矢:
        \begin{equation}
            \left \langle f_{p^\prime}  | f_{p}  \right \rangle=\int \left | A \right |^2e^{\frac{i(p-p^\prime )x}{\hbar } }\mathrm{d}x =\left | A \right |^22\pi\hbar \delta(p-p^\prime) 
        \end{equation}
        我们取\[\left|A\right|=\frac{1}{2\pi\hbar}\]
        与离散基相似我们得到了一个“正交归一系”
        \begin{equation}
            \left \langle f_{p^\prime}  | f_{p}  \right \rangle=\delta(p-p^\prime)
        \end{equation}

        由于这些本征右矢实际上是广义右矢, 所以我们说他们在\textbf{狄拉克意义下正交}, 区别于通常所说的正交关系, 但是非常相似。
        
        至于完备性, 对于连续基, 我们应该验证下面的式子:
        \begin{equation}
            \int_{{\nu _1}}^{{\nu _2}} {d\nu \left| {{\psi _\nu }} \right\rangle \left\langle {{\psi _\nu }} \right|} =\mathbbm{1}
        \end{equation}
        对于动量算符, 全体实数都可以作为本征值, 所以积分上下限, 也就是连续指标范围应该是$\left(-\infty,+\infty\right)$.
        \begin{align*}
            &\int_{-\infty }^{+\infty}\mathrm{d}p\left | f_p \right \rangle\left \langle f_p  | g  \right \rangle   \\
            =&\int_{-\infty }^{+\infty }\frac{1}{\sqrt{2\pi\hbar}}e^{\frac{ipx}{\hbar}}\int_{-\infty }^{+\infty }\frac{1}{\sqrt{2\pi\hbar}}e^{\frac{-ipx}{\hbar}}g(x)\mathrm{d}x \mathrm{d}p\\   
            =&\mathscr{F}^{-1}\left[\mathscr{F}\right(g)]=g(x)
        \end{align*}
        所以本征值为实数的本征矢构成了一个\textbf{完备的}正交归一系。
    \end{thinknote}
    从上面的例子我们就注意到, 对于连续谱的厄米算符, 如果是观察算符, 那么应该满足连续的封闭性关系和狄拉克意义下的正交归一性：
    \begin{equation*}
        \begin{array}{c}
            \left \langle \psi_\nu   | \psi_{\nu^\prime }  \right \rangle=\delta (\nu -\nu ^\prime ) \\
            \int_{{\nu _1}}^{{\nu _2}} {d\nu \left| {{\psi _\nu }} \right\rangle \left\langle {{\psi _\nu }} \right|} =\mathbbm{1}
        \end{array}
    \end{equation*}
    再看一例。
    \begin{thinknote}
        \textbf{位置算符的本征值和本征矢}
        \begin{equation}
            xg_y(x)=yg_y(x)
        \end{equation}
        根据$\delta$函数的取样性质可以得出:
        \[g_y(x)=\delta(x-y),y\in\mathbbm{R}\]
        \begin{align*}
            \int g_{y^\prime} ^*(x)g_y(x)\mathrm{d}x & = \int \delta (x-y^\prime )\delta(x-y)\mathrm{d}x\\ 
            & = \delta (y-y^\prime )
        \end{align*}
        \begin{align*}
            f(x)&=\int\delta(x-y)f(y)\mathrm{d}y\\
                &=\int\delta(x-y)\int\delta(x-y)f(x)\mathrm{d}x\mathrm{d}y\\
                &\equiv\int\mathrm{d}y\left | g_y \right \rangle\left \langle g_y  | f \right \rangle   
        \end{align*}
    \end{thinknote}
    我们再次发现, 在连续谱情况下, 对于实本征值对应的本征矢也有和离散谱下类似的性质。
    \subsection*{可对易观察算符的集合}
    下面的讨论都以离散谱为例。
    \begin{theorem}{可对易算符$\hat{A}$的本征子空间在$\hat{B}$的作用下不变}
        \begin{equation*}
            \left [ \hat A,\hat B \right ] =0\land \hat{A}\left | \psi  \right \rangle =\alpha\left | \psi  \right \rangle \Rightarrow\hat{A}(\hat B\left | \psi  \right \rangle )=\alpha(\hat B\left | \psi  \right \rangle  )
        \end{equation*}
        也就是说$\hat{A}$的本征矢被$\hat{B}$作用后仍然是属于同一本征值的本征矢, 也即$\hat{A}$的本征空间在$\hat{B}$的作用下不变。
    \end{theorem}
    \begin{theorem}{可对易观察算符的一个性质}
        若$\left | \psi_1  \right \rangle  $和$\left | \psi_2  \right \rangle  $分别是属于$\hat{A}$的\uwave{不同}本征值的本征矢, 那么:
        \[\left\langle {{\psi _1}} \right|\hat B\left| {{\psi _2}} \right\rangle \]
    \end{theorem}
    使用前面两个定理, 我们可以得到一个基本定理:
    \begin{theorem}{基本定理}
        可对易观察算符$\hat A,\hat B $的共同本征矢构成态空间的一个正交归一基。
    \end{theorem}
    上面的定理告诉我们对应于两个可对易观察算符, 我们总能找到一组基底使得他们\textbf{同时对角化}。
    \begin{thinknote}
        Proof:

        按照我们之前已经提到的本征矢的标记方法, 我们记
        \[\hat A\left| {{\rm{u}}_n^i} \right\rangle  = {a_n}\left| {{\rm{u}}_n^i} \right\rangle \]
        并且, 由于$\hat{A}$是观察算符, 所以我们假定我们已经对这些本征矢做了归一化处理, 他们构成了一个完备的正交归一基。所以在这个表象下$\hat{A}$的矩阵是一个
        对角矩阵我们来看一下$\hat{B}$在这个表象下的矩阵元:
        \[\left\langle {{\rm{u}}_n^i} \right|\hat B\left| {{\rm{u}}_n^i} \right\rangle \xrightarrow{\text{定理}\uppercase\expandafter{\romannumeral2}}\text{$n\neq n^\prime$时, 矩阵元为$0$}\]
        假设基底的排列顺序如下:
        \[\left|u_{1}^{1}\right\rangle,\left|u_{1}^{2}\right\rangle, \cdots,\left|u_{1}^{g_{1}}\right\rangle ; \quad\left|u_{2}^{1}\right\rangle,\left|u_{2}^{2}\right\rangle, \cdots,\left|u_{2}^{g_{2}}\right\rangle ; \quad\left|u_{3}^{1}\right\rangle, \cdots\]
        
        那么在这样的排列顺序下, $\hat{B}$的矩阵是一个分块对角阵(\ref{分块对角阵})。
        我们考察第$k$个本征子空间$\mathscr{E}_k$
        \begin{itemize}
            \item $g_k=1$\\
                   这时$\mathscr{E}_k$这个矩阵块在$\hat{B}$看来也是对角的, 也就是说归一化后的$\left| {{\text{u}}_k} \right\rangle $同时为$\hat A$
                   和$\hat B$的本征矢。
            \item $g_k\neq 1$\\
                   在这种情况下我们不知道$\mathscr{E}_k$这个矩阵块是不是对角的, 表象的这一部分是
                   \[\left|u_{k}^{1}\right\rangle,\left|u_{k}^{2}\right\rangle, \cdots,\left|u_{1}^{g_{k}}\right\rangle\]
                   但是可能无法使得$\hat{B}$对角化, 所以需要重新选择, 注意到这些本征矢的线性组合仍然是本征矢, 所以只要我们选取的新基底可以使用原先的$\mathscr{E}_k$这个矩阵块
                   对应的基底线性表示, 那么在这个新的表象下, $\hat{A}$仍然是对角化的。

                   根据第一个定理, 我们可以得出${\left. {\hat B} \right|_{\mathscr{E}_k}}$是$\mathscr{E}_k$上的一个算符, 而且因为$\hat{B}$是观察算符
                   , 所以${\left. {\hat B} \right|_{\mathscr{E}_k}}$是$\mathscr{E}_k$是厄米的, 这里再使用有限维向量空间中的复谱定理, 始终可以在$\mathscr{E}_k$中
                   选取一个正交归一基, 使得${\left. {\hat B} \right|_{\mathscr{E}_k}}$对角化, 而这一组基很显然刚好就是$\hat{A}$和$\hat{B}$的公共本征矢。
        \end{itemize}

        我们对于所有的本征子空间都做出这样的选取后, 由于本征空间的和是直和(不同本征值对应的本征矢显然线性无关), 我们把这些基并起来便构成了$\mathscr{E}_k$的一个基底。
        \hfill $\square$\par
    \end{thinknote}
    \begin{figure}[htbp]
        \centering
        \includegraphics[scale=0.3]{fig/3-1.eps}
        \caption{$\hat{B}$的矩阵}
        \label{分块对角阵}
    \end{figure}
    \section{广义概率诠释}
    薛定谔只是捣鼓出来了一个波函数方程, 但全然不知波函数方程的物理意义是什么, 前面我们说了它的模方可以解释为粒子位置分布的概率密度函数, 这是广义解释的一个特例。
    \begin{proposition}{广义概率诠释}
        \setlength\parindent{2em}先考虑离散谱情况。我们对一个量子态$\Psi(x,t)$进行测量, 会得到观察算符$\hat{Q}$的一个本征值$q_n$, 而且因为测量, 体系会坍缩为$q_n$对应的一个本征态$\left|u_n^i\right\rangle$(已正交归一化)\footnote[1]{就是前面讲的定值态}, 而具体坍缩到这个本征态
        的概率为:
        \begin{equation}
            \mathscr{P}_n^i=\left | c_n^i \right | ^2,c_n^i=\left\langle {{{\text{u}}_n^i}}
            \mathrel{\left | {\vphantom {{{\text{u}}_n^i} \Psi }}
            \right. \kern-\nulldelimiterspace}
            {\Psi } \right\rangle 
        \end{equation}
        那么, 测量值为$q_n$的概率为\footnote[2]{对于非简并情况, $\{\Ket{u_n^i}\}$这一组基的选取是多种多样的, 要注意坍缩只是坍缩为一个本征态, 不一定就是这组基里面的矢量, 利用上面的式子照样可以计算坍缩概率, 只是选取一组基方便我们下面计算测量到某个值的概率罢了, 而且可以证明下面的计算结果与基底的选取无关。}:
            \[\mathscr{P}_n=\sum\limits_{i=1}^{g_n}\mathscr{P}_n^i\]
        
        \setlength\parindent{2em}对于连续谱, 我们前面提到过其本征矢是没有物理意义的, 也就是说, 进行测量时, 体系不会坍缩为一个确定的本征态, 而是一个很狭窄的
        范围, 因为只有这些本征矢组合成的波包才有确定的物理意义。

        \setlength\parindent{2em}对于非简并连续谱, 测量值在$\alpha\sim\alpha+\mathrm{d}\alpha$范围内的概率为:
        \begin{equation}
            \mathscr{P}(\alpha)\mathrm{d}\alpha=\left|c(\alpha)\right|^2\mathrm{d}\alpha,c(\alpha)=\left \langle u_\alpha  | \Psi  \right \rangle 
        \end{equation}
        这时, $\mathscr{P}(\alpha)$已经过渡为一个概率密度函数。

        \setlength\parindent{2em}至于连续非简并、部分连续部分离散等等情况都很容易依照上面的思路直接进行推广。
    \end{proposition}
    下面的叙述都以离散非简并情况为例, 对于一般情况也很好扩展。

    对于观察算符, 我们已经知道它的正交归一系是完备的, 所以态可以展开成:
    \[\left | \Psi  \right \rangle =\sum\limits_{n=1}^{\infty } c_n\left | u_n \right \rangle \]
    $c_n$就是态在某个本征态上的分量, 这样来看似乎前面的概率诠释也很有道理, 但是注意, 概率一定要取这个分量的模方。

    由于波函数在任何时间都是归一化的, 那么:
    \begin{equation*}
        1 = \left\langle {\Psi }
    \mathrel{\left | {\vphantom {\Psi  \Psi }}
    \right. \kern-\nulldelimiterspace}
    {\Psi } \right\rangle  = \left\langle \Psi  \right|\mathbbm{1}\left| \Psi  \right\rangle  = \sum\limits_n {\left\langle {\Psi }
    \mathrel{\left | {\vphantom {\Psi  {{u_n}}}}
    \right. \kern-\nulldelimiterspace}
    {{{u_n}}} \right\rangle \left\langle {{{u_n}}}
    \mathrel{\left | {\vphantom {{{u_n}} \Psi }}
    \right. \kern-\nulldelimiterspace}
    {\Psi } \right\rangle }  = \sum\limits_n {c_n^*{c_n} = } \sum\limits_n {{{\left| {{c_n}} \right|}^2}} 
    \end{equation*}
    从概率的角度看, 这个理论完全自洽。
    \begin{align*}
        \left\langle \Psi \right| \hat{Q}  \left| \Psi  \right\rangle & = \left\langle \Psi \right| \hat{Q} \mathbbm{1} \left| \Psi  \right\rangle = \sum_{n} \left\langle \Psi \right| \hat{Q} \left| u_n  \right \rangle\left \langle u_n  | \Psi  \right \rangle \\ 
        &=\sum_{n} q_n\left\langle  \Psi  |u_n  \right\rangle\left \langle u_n  | \Psi  \right \rangle\\
        &=\sum_{n} q_n\left| c_n \right| ^2\\
        &=\left\langle Q \right\rangle 
    \end{align*}
    我们得到了计算测量平均值的一般方法, 与前面提到的方法完全一致：
    \begin{equation}
        \label{eq:3.14}
        \boxed{\left\langle Q \right\rangle=\left\langle \Psi \right| \hat{Q}  \left| \Psi  \right\rangle}
    \end{equation}
    \begin{thinknote}
        \setlength\parindent{2em}前面已经算出了位置和动量算符的本征值及本征矢, 那么粒子位置的概率分布函数:
        \begin{align*}
            c\left ( y \right ) & = \left \langle g_y| \Psi  \right \rangle \\& = \int \Psi \left ( x,t \right ) \delta(x-y)\mathrm{d}x
            \\&=\Psi \left ( y,t \right ) 
        \end{align*}
        和波函数是完全一致的, 波尔概率诠释也就是这个内容。

        \setlength\parindent{2em}粒子动量的密度分布函数也可以计算出来:
        \begin{align*}
            c\left ( p \right ) & = \left \langle f_p  | \Psi  \right \rangle \\ & = \frac{1}{\sqrt{2\pi\hbar} } \int  \Psi(x,t)e^{-\frac{ipx}{\hbar } }\\
            &\equiv \Phi(p,t)
        \end{align*}
    \end{thinknote}
    这里引入了一个新的概念, \textbf{动量空间波函数}, $\Phi(p,t)$. 原先的$\Psi(x,t)$可以称为\textbf{位置空间波函数}。他们之间的关系就是傅里叶变换\footnote[1]{量子力学里面更喜欢这样写傅里叶变换, 很容易证明它和我们之前讲自由粒子波函数时引进的傅里叶变换的等价性}:
    \begin{align}
        &\Phi(p,t)=\frac{1}{\sqrt{2\pi\hbar}}\int\Psi(x,t)e^{-\frac{ipx}{\hbar}}\mathrm{d}x\\
        &\Psi(x,t)=\frac{1}{\sqrt{2\pi\hbar}}\int\Phi(p,t)e^{\frac{ipx}{\hbar}}\mathrm{d}p
    \end{align}
    两个表示粒子状态的波函数都非常重要。
    \begin{proposition}{算符的两种不同形式}
        我们之前提到的$\hat x=x,\hat p=-i\hbar\frac{\partial}{\partial x}$实际上时算符在位置空间\footnote[1]{暂时先这么说, 实际上应该说成$\left|\bm{r}\right\rangle$}下的描述, 在动量空间中应该是\footnote[2]{为了和前面区分, 我改用$\tilde{}$表示算符}:
        \[\tilde{x}=i\hbar\frac{\partial}{\partial p},\tilde{p}=p\]
        或者更一般的, 使用两种不同空间波函数求力学量平均值应该写成:
        \begin{equation}
            \langle Q(x, p, t)\rangle=\left\{\begin{array}{ll}
                \int \Psi^{*} \hat{Q}\left(x,-i \hbar \frac{\partial}{\partial x}, t\right) \Psi d x, & \text { in position space; } \\
                \int \Phi^{*} \hat{Q}\left(i \hbar \frac{\partial}{\partial p}, p, t\right) \Phi d p, & \text { in momentum space. }
                \end{array}\right.
        \end{equation}
    \end{proposition}
    概率诠释是量子力学逻辑体系里面的一条基本假设, 这条假设之前的一个假设是我们上一节提到的, \textbf{每个可观测量对应一个观察算符}。
    \begin{thinknote}
        \textbf{例：证明对于定态(能量本征态), 有$\braket{p}=0$。}

        \flushleft{Proof:}

        \setlength\parindent{2em}首先通过计算可以得到下面的关系：
        \[\left[x,\hat{p}^2\right]=2i\hbar\hat p\Rightarrow\left[x,\hat H\right]=\frac{i\hbar}{m}\hat p\]
        利用广义概率诠释：
        \begin{align*}
            \braket{p}&=\Braket{\Psi|\hat p|\Psi}=\Braket{\psi|\hat p|\psi}\\
            &=\Braket{\psi|\frac{m}{i\hbar}\left[x,\hat H\right]|\psi}\\
            &=\frac{m}{i\hbar}\left(\Braket{\psi|x\hat H|\psi}-\Braket{\psi|\hat H x|\psi}\right)
        \end{align*}
        第一个等号的成立是因为$\ket{\Psi}$和$\ket{\psi}$只相差一个$\phi(t)$(而这个的本质是因为薛定谔方程的可分离变量性), 而且相位因子对平均值的计算没有影响。
        
        \setlength\parindent{2em}由于$\ket{\psi}$是能量本征态(严格来说应该是$\ket{\Psi}$, 但是相位因子对于定态问题真的没啥作用, 有没有这个相位因子都还是本征矢), 所以有:
        \[\hat H\ket{\psi}=E\ket{\psi}\]
        又因为$\hat H$是厄米算符, 而且$E\in\mathbbm{R}$, 所以上式取厄米共轭得：
        \[\bra{\psi}\hat H=\bra{\psi}E\]
        \begin{equation*}
            \braket{p}=\frac{m}{i\hbar}\left(\braket{\psi|xE|\psi}-\braket{\psi|Ex|\psi}\right)=0
        \end{equation*}
        \hfill $\square$\par
    \end{thinknote}
    \section{不确定性原理}
    在知晓广义概率诠释之后, 我们下面规定$\left\langle Q \right\rangle$, 即观测量的平均值, 有时也索性直接写成$\left\langle \hat Q \right\rangle$, 它
    和$\left\langle \Psi \right| \hat{Q}  \left| \Psi  \right\rangle$直接对应。后面的推导有时也不会严格使用狄拉克符号, 但请记住下面的转换关系：
    \[\left|\hat Q\Psi\right\rangle=\hat Q\left|\Psi\right\rangle, \left\langle \hat Q \Psi\right|=\left\langle \Psi\right|\hat{Q}^\dagger\]
    \begin{theorem}{不确定性原理}
        对于任意两个可观测量$\hat{A}, \hat{B}$, 对同一个系综测量后得到的方差总是满足下面的关系式：
        \begin{equation}
            \label{不确定性原理}
            \boxed{
                \sigma_A\sigma_B\geq\frac{1}{2}\left|\left\langle\left[\hat A,\hat B\right]\right\rangle\right|
            }
        \end{equation}
    \end{theorem}
    \begin{thinknote}
        Proof:
        \begin{align}
            &\sigma _A^2 = \left\langle {{\left( {\hat A - \left\langle A \right\rangle } \right)\Psi }}
            \mathrel{\left | {\vphantom {{\left( {\hat A - \left\langle A \right\rangle } \right)\Psi } {\left( {\hat A - \left\langle A \right\rangle } \right)\Psi }}}
            \right. \kern-\nulldelimiterspace}
            {{\left( {\hat A - \left\langle A \right\rangle } \right)\Psi }} \right\rangle  \equiv \left\langle {f}
            \mathrel{\left | {\vphantom {f f}}
            \right. \kern-\nulldelimiterspace}
            {f} \right\rangle \\
            &\sigma _B^2 = \left\langle {{\left( {\hat B - \left\langle B \right\rangle } \right)\Psi }}
            \mathrel{\left | {\vphantom {{\left( {\hat B - \left\langle B \right\rangle } \right)\Psi } {\left( {\hat B - \left\langle B \right\rangle } \right)\Psi }}}
            \right. \kern-\nulldelimiterspace}
            {{\left( {\hat B - \left\langle B \right\rangle } \right)\Psi }} \right\rangle  \equiv \left\langle {g}
            \mathrel{\left | {\vphantom {g g}}
            \right. \kern-\nulldelimiterspace}
            {g} \right\rangle 
        \end{align}
        根据Cauchy-Schwarz不等式, 可以得到：
        \[\sigma _A^2\sigma _B^2 = \left\langle {f}
        \mathrel{\left | {\vphantom {f f}}
        \right. \kern-\nulldelimiterspace}
        {f} \right\rangle \left\langle {g}
        \mathrel{\left | {\vphantom {g g}}
        \right. \kern-\nulldelimiterspace}
        {g} \right\rangle  \geqslant {\left| {\left\langle {f}
        \mathrel{\left | {\vphantom {f g}}
        \right. \kern-\nulldelimiterspace}
        {g} \right\rangle } \right|^2}\]
        任意复数可以拆分实部和虚部：
        \[{\left| {\left\langle {f}
        \mathrel{\left | {\vphantom {f g}}
        \right. \kern-\nulldelimiterspace}
        {g} \right\rangle } \right|^2} = {\left( {\operatorname{Re} \left\langle {f}
        \mathrel{\left | {\vphantom {f g}}
        \right. \kern-\nulldelimiterspace}
        {g} \right\rangle } \right)^2} + {\left( {\operatorname{Im} \left\langle {f}
        \mathrel{\left | {\vphantom {f g}}
        \right. \kern-\nulldelimiterspace}
        {g} \right\rangle } \right)^2} \geqslant {\left( {\operatorname{Im} \left\langle {f}
        \mathrel{\left | {\vphantom {f g}}
        \right. \kern-\nulldelimiterspace}
        {g} \right\rangle } \right)^2}\]
        \[\operatorname{Im} \left\langle {f}
        \mathrel{\left | {\vphantom {f g}}
        \right. \kern-\nulldelimiterspace}
        {g} \right\rangle  = \frac{{\left\langle {f}
        \mathrel{\left | {\vphantom {f g}}
        \right. \kern-\nulldelimiterspace}
        {g} \right\rangle  - \left\langle {g}
        \mathrel{\left | {\vphantom {g f}}
        \right. \kern-\nulldelimiterspace}
        {f} \right\rangle }}{{2\mathrm{i}}}\]
        \begin{align*}
            \left\langle {f}
            \mathrel{\left | {\vphantom {f g}}
            \right. \kern-\nulldelimiterspace}
            {g} \right\rangle  &= \left\langle {{\left( {\hat A - \left\langle A \right\rangle } \right)\Psi }}
            \mathrel{\left | {\vphantom {{\left( {\hat A - \left\langle A \right\rangle } \right)\Psi } {\left( {\hat B - \left\langle B \right\rangle } \right)\Psi }}}
            \right. \kern-\nulldelimiterspace}
            {{\left( {\hat B - \left\langle B \right\rangle } \right)\Psi }} \right\rangle  \\ 
                &= \left\langle {\Psi }
            \mathrel{\left | {\vphantom {\Psi  {\left( {\hat A - \left\langle A \right\rangle } \right)\left( {\hat B - \left\langle B \right\rangle } \right)\Psi }}}
            \right. \kern-\nulldelimiterspace}
            {{\left( {\hat A - \left\langle A \right\rangle } \right)\left( {\hat B - \left\langle B \right\rangle } \right)\Psi }} \right\rangle  \\ 
                &= \left\langle \Psi  \right|\hat A\hat B\left| \Psi  \right\rangle  - \left\langle A \right\rangle \left\langle \Psi  \right|\hat B\left| \Psi  \right\rangle  - \left\langle B \right\rangle \left\langle \Psi  \right|\hat A\left| \Psi  \right\rangle  + \left\langle A \right\rangle \left\langle B \right\rangle \left\langle {\Psi }
            \mathrel{\left | {\vphantom {\Psi  \Psi }}
            \right. \kern-\nulldelimiterspace}
            {\Psi } \right\rangle  \\ 
                &= \left\langle {\hat A\hat B} \right\rangle  - \left\langle A \right\rangle \left\langle B \right\rangle  \\ 
            \end{align*} 
        第二个等号成立是因为$\left\langle A \right\rangle \in \mathbbm{R}$且$\hat A$是厄米算符, 所以${\hat A - \left\langle A \right\rangle }$是厄米的。

        同理可得：
        \[\left\langle {g}\mathrel{\left | {\vphantom {g f}}\right. \kern-\nulldelimiterspace}{f} \right\rangle  = \left\langle {\hat B\hat A} \right\rangle  - \left\langle A \right\rangle \left\langle B \right\rangle \]
        结合上面的等式立即得到:
        \[\sigma _A^2\sigma _B^2 = {\left| {\frac{1}{{2i}}\left\langle {\left[ {\hat A,\hat B} \right]} \right\rangle } \right|^2}\]
        推导不确定性关系不需要额外的假设, 它可以看作是概率诠释和柯西不等式的一个推论。
        \hfill $\square$\par
    \end{thinknote}
    这个不等式中, 所谓的\uwave{不确定度}就蕴含在$\sigma$中, 它就表征了我们对一个系综测量, 整个测量结果的数据分散程度, 偏离平均值的程度。
    对于位置和动量之间的不确定性正是上面的普遍关系式的一个推论:
    \begin{equation}
        \label{x-p 不确定性}
        {\sigma _x}{\sigma _p} \geqslant \frac{1}{2}\left| {\left\langle {\left[ {\hat x,\hat p} \right]} \right\rangle } \right| = \frac{1}{2}\left| {\left\langle {i\hbar } \right\rangle } \right| = \frac{\hbar }{2}
    \end{equation}
    \begin{history}{海森堡对不确定性关系的理解}
        \setlength\parindent{2em}最初解释不确定性关系的时候, 海森堡总是认为它和测量是相关的, 因此有了个著名的思想实验。大致说的是当我们对一个电子进行测量时, 我们需要使用一个光子
        去撞击它, 也就是说会对它本身进行干扰, 我们对位置了解的越多, 那么我们对它的干扰也就越大, 我们对动量的了解程度就越少, 反之, 我们对动量了解的越多, 对
        位置信息了解的也越少了。
        
        \setlength\parindent{2em}这是海森堡当时对不确定性原理的解释, 因此不确定性原理也在上世纪常常被称为测不准原理, 事实上这个理解是很有问题的, 不确定性原理是量子力学不同于经典力学的
        一个原理, 是粒子本身的性质, 是一个普遍物理规律, 和你是否进行测量是毫无关系的。
    \end{history}
    在前面我们证明过, 两个可对易观察算符可以同时对角化。我们称在这两个\textbf{可观测量是相容的}, 从不确定性原理的角度理解就是这两个观测量是可以同时测量的。
    测量两个量的顺序是无关紧要的, 测量$A$之后测量$B$也不会让第一次测量的信息得到损失, 反而会得到补充, 这一切的一切定性点来看就是两次坍缩得到的本征态同时是两个
    算符的本征态。仔细分析有点复杂, 可以参考科恩第三章$\S B$。

    我们再来看一下不等式\ref{不确定性原理}等号成立的\uwave{必要条件}:
    \[g = cf \wedge \operatorname{Re} \left\langle {f}\mathrel{\left | {\vphantom {f g}}\right. \kern-\nulldelimiterspace}{g} \right\rangle  = 0,c\in \mathbbm{C}\]
    根据内积的正定性, 直接得到$c$是一个纯虚数, 我们记作$\mathrm{i}a$, 其中$a\in\mathbbm{R}$

    回到动量位置不确定性关系上来, 如果式\ref{x-p 不确定性}可以取等号, 那么根据前面分析
    \[\left( {\hat p - \left\langle p \right\rangle } \right)\Psi  = ia\left( {\hat x - \left\langle x \right\rangle } \right)\Psi  \Rightarrow \left( { - i\hbar \frac{d}{{dx}} - \left\langle p \right\rangle } \right)\Psi  = ia\left( {x - \left\langle x \right\rangle } \right)\Psi \]
    解微分方程得到波函数的形式是\footnote[1]{$\left\langle x \right\rangle,\left\langle p \right\rangle$和位置$x$无关。}:
    \begin{equation}
        \Psi  = A{e^{ - \frac{a}{{2\hbar }}{{\left( {\hat x - \left\langle x \right\rangle } \right)}^2}}}{e^{\frac{i}{\hbar }\left\langle p \right\rangle x}}
    \end{equation}
    这显然是一个高斯分布的形式。当然, 只是当某个时刻波函数有这个形式时式\ref{x-p 不确定性}取等号, 之后波函数随时间演化后可能就不再满足取等条件了。
    \subsection*{时间能量不确定性关系}
    很多书籍把不确定性关系也写作
    \begin{equation}
       \Delta {x} \Delta {p} \ge \frac{\hbar}{{2 }} 
    \end{equation}
    对应的还会有一个时间和能量之间的不确定性关系\footnote[2]{从狭义相对论动力学的四位动量和四维时空坐标中你可以看出这种对应性}:
    \begin{equation}
        \label{E-t}
        \Delta {t} \Delta {E} \ge \frac{\hbar}{{2 }}
    \end{equation}
    
    
    这两个公式看起来非常相似, 但是物理实质却有很大的区别, 从$\Delta t$就可以看出来。难道指的是时间的标准差？时间只是演化之中的一个参数而已, 何来标准差一说。
    所以从我们下面的推导中, 要格外注意两个公式的不同之处。
    \begin{equation}
        \label{求导式子}
        \frac{d}{d t}\langle Q\rangle=\frac{d}{d t}\langle\Psi|\hat{Q}| \Psi\rangle=\Braket{\frac{\partial \Psi}{\partial t}|\hat{Q}| \Psi}+\Braket{\Psi|\frac{d \hat{Q}}{d t}|\Phi}+\Braket{\Psi|\hat{Q}| \frac{\partial \Psi}{\partial t}}
    \end{equation}
    上面的求导具体过程可以使用定义直接推导, 有点像实分析中三个函数相乘的导数公式。\footnote[3]{$\Ket{\frac{\partial \Psi}{\partial t}}$表示$\frac{\partial }{\partial t}\Ket{\Psi}$, 对应的左矢为$\Bra{\frac{\partial \Psi}{\partial t}}$, 注意不是$\frac{\partial }{\partial t}\Bra{\Psi}$}
    
    含时薛定谔方程可以写为\footnote[4]{严格使用狄拉克符号的话这里的$\Psi$要加上$\ket{}$}:
    \[i\hbar\frac{\partial \Psi}{\partial t}=\hat H\Psi\Rightarrow\frac{\partial \Psi}{\partial t}=-\frac{i\hat H}{\hbar}\Psi\]
    代入\ref{求导式子}得到:
    \begin{align*}
        \frac{d\braket{Q}}{dt}&=\Braket{\frac{\hat{H}}{i\hbar}\Psi |\hat{Q}|\Psi}+\Braket{\Psi|\frac{\partial \hat{Q}}{\partial t}|\Psi}+\Braket{\Psi|\hat{Q}| \frac{\hat H}{i\hbar}\Psi}\\
        &=\frac{i}{\hbar}\Braket{\Psi|\hat H\hat Q|\Psi}+\Braket{\Psi|\frac{\partial \hat{Q}}{\partial t}|\Psi}-\frac{i}{\hbar}\Braket{\Psi|\hat Q\hat H|\Psi}\\
        &=\frac{i}{\hbar}\Braket{\Psi|\left[\hat H,\hat Q\right]|\Psi}+\Braket{\frac{\partial \hat Q}{\partial t}}
    \end{align*}
    也就是说对于任何的可观测量, 我们可以得到它的平均值随时间变化的规律, 是与体系的哈密顿算符(量)之间相关的：
    \begin{equation}
        \label{广义欸费斯托定理}
        \boxed{
            \frac{d\braket{Q}}{dt}=\frac{i}{\hbar}\Braket{\Psi|\left[\hat H,\hat Q\right]|\Psi}+\Braket{\frac{\partial \hat Q}{\partial t}}
        }
    \end{equation}
    当\ref{广义欸费斯托定理}中的$\hat Q=\hat p$时\footnote[2]{我们目前的讨论都在位置空间中, 所以$\hat p=-i\hbar\frac{\partial}{\partial x}$}, 我们得到\textbf{Ehrenfest's theorem}:
    \begin{equation}
        \boxed{\frac{d}{dt}\braket{p}=\Braket{-\frac{\partial V(x)}{\partial x}}}
    \end{equation}
    
    一般来说, 很多算符都是不显含时间的, 与时间无关, 我们着重研究这些算符, 式\ref{广义欸费斯托定理}写成:
    \[\frac{d\braket{Q}}{dt}=\frac{i}{\hbar}\Braket{\Psi|\left[\hat H,\hat Q\right]|\Psi}\]
    又因为$\hat{H}$和$\hat{Q}$都是两个可观测量, 那么由不确定性原理有：
    \[\sigma_H\sigma_Q\geq\frac{1}{2}\left|\Braket{\left[\hat H,\hat Q\right]}\right|\]
    联立以上两式, 得：
    \begin{equation}
        \label{H-Q}
        \sigma_H\sigma_Q\geq\frac{\hbar}{2}\left|\frac{d\braket{Q}}{dt}\right|
    \end{equation}
    由于哈密顿量对应的是体系的能量, 所以我们把$\sigma_H$记作$\Delta E$, 为了凑出不确定性原理, 我们\textbf{定义}$\Delta t$为：
    \begin{equation}
        \label{define dt}
        \sigma_Q=\left|\frac{d\braket{Q}}{dt}\right|\Delta t
    \end{equation}
    
    它确实具有时间量纲, 可见这个时候, \ref{E-t}和我们关注的可观测量是相关的。按照上面的公式你可以严格去验证不确定性原理, 但是这通常很麻烦, 借用计算机方面的
    一个词语, \textbf{时间能量不确定性关系又很好的鲁棒性}。所以我们一半对于$\Delta t$的解释很随意, 用来进行一些估算是很好的, 根据$\Delta t$的定义, 其实我们也有理由
    说：\textbf{\textcolor{red}{$\Delta t$可以解释为系统产生一个“显著”的变化所需要的时间}}。
    \begin{thinknote}
        “显著”变化的时间, 这个论述就非常的缺乏严谨性, 非常模棱两可。所以这个不等式中的$\Delta t$在很多情况下都有非常“物理”的解释, 可以说通, 但比不上式\ref{define dt}的
        严谨性, 很多时候这个式子用来估算非常好, 这方面的例子{\itshape Griffiths}书里面有三个。
    \end{thinknote}
    \section{表象理论}
    {\itshape Griffiths}书里面的这一节的绝大部分内容在附录\ref{Appendix B}中已讲, 这里我们回到{\itshape Cohen}第二章, 给狄拉克符号相关内容结尾。
    
    在附录\ref{Appendix B}中我们最先研究了波函数空间$\mathscr{F}$, 这里的波函数指的是以坐标为参数表示的波函数, 可以用波函数表示一个量子态。但是实际上我们发现量子态更本质上可以
    使用态矢量来描述, 我们便引进了$\mathscr{E}_r$空间, 实际上你可以认为波函数空间中的元素就是对应态空间矢量在\uwave{位置表象}下的分量函数。实际上, 量子力学的一个基本假设就是任何一个体系的
    量子态可以使用态空间中的一个右矢表示, 在附录\ref{Appendix B}中我们已经讨论了这个空间的运算性质, 其代数本质是线性空间, 下面我们正式从$\mathscr{F}$空间定义与其联系的$\mathscr {E}_r$空间, 其实就是一个
    通过分量和一组完备的正交基确定矢量的过程。
    \begin{proposition}{$\mathscr{F}$空间与$\mathscr {E}_r$空间的联系}
        对于波函数空间中的每一个波函数$\psi(bm{r})$, 我们唯一选取态空间中的一个右矢$\ket{\psi}$与之对应, 这种对应是线性的, 而且这种对应使得内积定义为\footnote[1]{我们正是在定义一个内积空间}:
        \begin{equation}
            \label{eq:3.30}
            \braket{\varphi|\psi}=\int d^3r\varphi^*(\bm{r})\psi(\bm{r})
        \end{equation}
    \end{proposition}
    我们下面的讨论直接使用三维形式, 实际上就是每个维度的缩并形式。
    \subsection*{$\ket{\bm{r}}$和$\ket{\bm{p}}$表象}
    波函数空间中可以找到两组不属于$\mathscr{F}$的基, 满足封闭性关系和狄拉克正交归一关系：
    \begin{align}
        \label{eq:3.31}& \xi_{\bm{r}_0}(\bm{r})=\delta({\bm{r}-\bm{r}_0})\\
        \label{eq:3.32}& \nu_{\bm{p}_0}(\bm{r})=\left(2\pi\hbar\right)^{-\frac{3}{2}}e^{\frac{i}{\hbar}\bm{p}_0\cdot\bm{r}}
    \end{align}
    
    我们可以给这两个波函数分别对应两个\uwave{广义右矢}$\ket{\bm{r}_0},\ket{\bm{p}_0}$。再根据\ref{eq:3.30}我们可以得出态矢量$\Ket{\Psi}$在这两组基下的分量：
    \begin{align}
        &\Braket{\bm{r}_0|\Psi}=\Psi(\bm{r}_0)\\
        &\Braket{\bm{p}_0|\Psi}=\mathscr{F}\left[\Psi(\bm{r})\right](\bm{p}_0)=\Phi(\bm{p}_0)
    \end{align}
    可见态矢量在$\ket{\bm{r}}$上的分量正是波函数在这个指标下的取值。我们将$\ket{\bm{r}_0}$换成$\ket{\bm{r}}$, 那么内积得到的就是一个关于$\ket{\bm{r}}$
    的函数, 也正是波函数本身。我们将上式写成下面更紧凑的形式, 方便我们看清之前定义的位置空间波函数和动量空间波函数的意义：
    \begin{align}
        &\braket{\bm{r}|\Psi}=\Psi(\bm{r})\Rightarrow \ket{\Psi}=\int d^3r \ket{\bm{r}}\braket{\bm{r}|\Psi}=\int d^3r \Psi(\bm{r})\ket{\bm{r}}\\
        &\braket{\bm{p}|\Psi}=\Phi(\bm{p})\Rightarrow \ket{\Psi}=\int d^3p \ket{\bm{r}}\braket{\bm{p}|\Psi}=\int d^3p \Phi(\bm{p})\ket{\bm{p}}
    \end{align}
    实际上, 任何一个可观测量对应的观察算符的特征矢都可以组成一个规范正交基(满足\ref{eq:B.12}和\ref{eq:B.13}), 也就确定了一个表象。比如同样经常用的能量表象, 就是根据
    哈密顿算符定义的, 也就是我们第二章一直在求的定态解$\ket{\psi}$, 他们也可以构成一个基底, 对于束缚态同样可以写：
    \[\ket{\Psi}=\sum\limits_n c_n\ket{\psi_n}\]  
    如果量子态$\ket{\Psi}$随时间演化, 那么上面的分量波函数或者是$c_n$都要带上时间参量, 基底还是一般不用随时变的。
    
    根据式\ref{eq:3.31}和式\ref{eq:3.32}, 我们可以得到\[\braket{\bm{r}|\bm{p}}=\left(2\pi\hbar\right)^{-\frac{3}{2}}e^{\frac{i}{\hbar}\bm{p}\cdot\bm{r}}\]
    使用附录B中类似的方法, 可以得到表象之间的变换关系：
    \begin{align*}
        \Phi(\bm{r})&=\Braket{\bm{r}|\Psi}=\Braket{\bm{r}|\mathbbm{1}|\Psi}\\
        &=\int d^3p\Braket{\bm{r}|\bm{p}}\Braket{\bm{p}|\Psi}=\int d^3p\left(2\pi\hbar\right)^{\frac{3}{2}}e^{\frac{i}{\hbar}\bm{p}_0\cdot\bm{r}}\Phi(\bm{p})\\
        &=\mathscr{F}^{-1}\left[\Phi(\bm{p})\right](\bm{r})
    \end{align*}
    我们使用了一种新的方式去说明两种波函数之间的傅里叶变换关系, 当然, 这里的傅里叶变换是一个三维形式。
    \subsection*{算符$\hat{\bm{R}}$和算符$\hat{\bm{P}}$}
    下面我们要讨论的可以看作是$\hat x$和$\hat p$的三维形式。
    \begin{define}{两个重要算符}
        \begin{itemize}
            \item 算符$\hat{\bm{R}}$\\
            这个算符在$\ket{\bm{r}}$表象下由三个“分量算符”$X,Y,Z$确定。\footnote[1]{这里的$\bm{r}$是个缩并的记号, 波函数实际上是一个三元函数$\Psi(x,y,z)$, 下式中的$x,y,z$就是包含在$\ket{\bm{r}}$中的三个指标。算符$\hat{\bm{P}}$同理。}
            \begin{align*}
                &\Braket{\bm{r}|X|\Psi}=x \Braket{\bm{r}|\Psi}=x\Psi(\bm{r})\\
                &\Braket{\bm{r}|Y|\Psi}=y \Braket{\bm{r}|\Psi}=y\Psi(\bm{r})\\
                &\Braket{\bm{r}|Z|\Psi}=z \Braket{\bm{r}|\Psi}=z\Psi(\bm{r})
            \end{align*}
            \item 算符$\hat{\bm{P}}$\\
            这个算符在$\ket{\bm{p}}$表象下由三个“分量算符”$P_x,P_y,P_z$确定。\footnote[2]{如果考虑随时间演化的态, 式中要加上时间项, 形式不变。}
            \begin{align*}
                &\Braket{\bm{p}|P_x|\Psi}=p_x \Braket{\bm{p}|\Psi}=p_x\Phi(\bm{p})\\
                &\Braket{\bm{p}|P_y|\Psi}=p_y \Braket{\bm{p}|\Psi}=p_y\Phi(\bm{p})\\
                &\Braket{\bm{p}|P_z|\Psi}=p_z \Braket{\bm{p}|\Psi}=p_z\Phi(\bm{p})
            \end{align*}
        \end{itemize}
    \end{define}
    那么根据上面的定义, 就可以解释我们一直说的在位置空间中$\hat{x}\leftrightarrow x$, 换成矩阵的语言, 就是在位置表象下, 算符$\hat{x}$的矩阵是$x\mathbbm{1}$, 因为波函数完全可以看作一个列矩阵。
    两者相乘便得到了$\hat{x}\ket{\psi}$在位置表象下的形式(波函数)。

    我们来看一下动量算符在位置表象下的形式, 我们不去直接计算矩阵元, 先将它作用于一个右矢再取分量可以很快的看出它的等价形式：
    \begin{align*}
        \Braket{\bm{r}|P_x|\Psi}&=\int d^3p\Braket{\bm{r}|\bm{p}}\Braket{\bm{p}|P_x|\Psi}=\int d^3pp_x\Braket{\bm{r}|\bm{p}}\Braket{\bm{p}|\Psi}\\
        &=\int d^3pp_x\left(2\pi\hbar\right)^{-\frac{3}{2}}e^{\frac{i}{\hbar}\bm{p}\cdot\bm{r}}\Phi(\bm{p})\\
        &=-i\hbar\frac{\partial}{\partial x}\int d^3p\left(2\pi\hbar\right)^{-\frac{3}{2}}e^{\frac{i}{\hbar}\bm{p}\cdot\bm{r}}\Phi(\bm{p})\\
        &=-i\hbar\frac{\partial}{\partial x}\Psi(\bm{r})
    \end{align*}
    所以在位置空间中$\hat p\leftrightarrow -i\hbar\frac{\partial}{\partial x}$, 进一步写成缩并形式便有：
    \begin{equation}
        \Braket{\bm{r}|\hat{\bm{P}}|\Psi}=-i\hbar\nabla\Braket{\bm{r}|\Psi}
    \end{equation}
    
    式\ref{eq:3.14}, 告诉了我们计算物理量平均值的办法, 实际上我们一般用的都是它在位置或动量空间下的形式, 严格点说, 式\ref{eq:3.14}可以利用封闭性关系重新写成
    \[\Braket{Q}=\int d^3r\Braket{\Psi|\bm{r}}\Braket{\bm{r}|\hat Q|\Psi}\]
    再利用上面已经得出的动量和位置算符在位置空间中的表示替换上式中的第二项即可, 也就是第一章就说的“把算符夹在中间, 然后积分”。

    很容易证明, $\ket{\bm{r}}$和$\ket{\bm{p}}$分别是$\hat {\bm{R}}$和$\hat {\bm{P}}$的本征矢。
    \subsection*{力学量完全集(CSCO)}
    对于某个观察算符$\hat{A}$, 可以选取一组它的正交归一本征矢$\{\ket{u^i_n}\}$作为$\mathscr{E}$中的一组基。如果对于$\hat A$的每一个本征值都是非简并的, 那
    么, 给定了$\hat{A}$的本征值也就唯一确定了这个正交归一基$\{\ket{u_n}\}$(显然这个时候我们不再需要额外使用指标$i$去区分), 因为每个本征子空间$\mathscr{E}_n$的维数都是一, 我
    们认为成比例的两个基矢是没有区别的, 即$\ket{u_n}\leftrightarrow e^{i\theta}\ket{u_n}$。这个时候我们就称算符$\hat{A}$单独构成了一个CSCO。
    
    如果存在一些非简并的本征值, 那么这个时候$\mathscr{E}_n$中本征矢的取法就有无限多种线性组合, 那么$\{\ket{u_n^i}\}$的取法就并不唯一了, 但我们这个时候如果引进一个
    与$\hat{A}$对易的算符$\hat{B}$, 考察他们的公共本征矢, 根据$\S{3.2}$的推导, 他们的公共本征矢构成了一组基$\{\ket{u_{n,p}^i}\}$, 由$\hat{A},\hat{B}$的本征矢对$\left(a_n,b_p\right)$确定。
    如果每一个本征矢对唯一确定了一个$\{\ket{u_{n,p}^i}\}$(同样, 成比例算作相同的本征矢), 那么$\hat{A},\hat{B}$的公共本征矢确定的基底是唯一的\footnote[1]{根据$\S{3.2}$构造这组基的过程
    , 可以发现, 这个条件等价于${\left. {\hat B} \right|_{\mathscr{E}_n}}$(也就是那每一个分块小矩阵)有$g_n$个不同的本征值, 其中$g_n\equiv \dim \mathscr{E}_n$}, 这时我们称$\{\hat{A},\hat{B}\}$
    构成了一个CSCO。
    
    如果这个时候对于每个本征矢对还是无法唯一确定一个本征矢, 那么我们可以引进第三个同时与$\hat A,\hat B$对易的算符$\hat C$, 再次按照前面的情况分类讨论, 一般的CSCO定义如下:
    \begin{define}{力学量完全集(CSCO)}
        \setlength\parindent{2em}按定义, 把观察算符$\hat A,\hat B,\hat C\cdots$的一个集合叫做可对易观察算符的完全集合的条件是:
        \begin{itemize}
            \item 所有的这些观察算符\uwave{两两对易}；
            \item 给出了全体算符$\hat A,\hat B,\hat C\cdots$的本征值的一个数组，便足以决定唯一的一个共同本征矢\footnote[1]{有且仅有($\exists!$)}(倍乘因子除外)。
        \end{itemize}
        \setlength\parindent{2em}或者说:存在着由共同本征矢构成的一个正交归一基，而且这个基是唯一的（除相位因子以外）。
    \end{define}
    比如三维问题中$\hat{bm{R}}$算符的三个分量算符$X,Y,Z$就构成了一个CSCO, 很容易证明它们两两对易, 而且给定了本征值$(x_0,y_0,z_0)$就唯一确定了本征矢$\ket{\bm{r}}$, 显然这正是$\ket{\bm{r}}$表象。

    \section{薛定谔方程的分离变量}
    第二章中我们直接从波函数出发, 给出了很多结论, 实际上现在看来就是一些更广泛的结论在位置表象下的描述。比如我们第二章都是分离变量先解出定态解, 然后说明波动方程
    的通解是这些定态解的线性组合。现在我们知道这些定态解就是哈密顿算符的本征矢(用$\ket{\psi_n}$表示), 哈密顿算符是一个观察算符, 显然这些本征矢构成了一组基, 那么态矢量显然就可以用这组基底表示(以离散谱为例):
    \begin{equation}
        \label{eq:3.38}
        \Ket{\Psi(t)}=\sum_n c_n(t)\ket{\psi_n}
    \end{equation}
    
    但是这远远不够, 显然, 我们如果不对$c_n$加以限制的话, 式\ref{eq:3.38}实际上可以表示态空间的所有矢量！真正满足量子力学规律的矢量显然有一定限制, 而这个限制就是通过薛定谔方程和$\ket{\psi_n}$对应的本征值完成的。
    实际上之前我们利用分离变量法求解薛定谔方程(哈密顿量不显含时间, 即保守体系)就已经得出了$c_n$要满足的规律(式\ref{find_c}), 即\[c_n(t)=c_n(0) e^{-iE_n t/\hbar}\]
    下面我们全程使用更广泛的狄拉克符号法来推导一下\footnote[1]{这里作为例子考虑最简单的离散谱非简并情况, 其他情况的推广非常简单}。
    
    我们之前解的薛定谔方程都是下面更加普遍的方程在$\ket{\bm{r}}$表象下的形式：
    \begin{lequation}
        \label{eq:3.39}
        i\hbar\frac{\partial}{\partial t}\ket{\Psi(t)}=\hat{H}\ket{\Psi(t)}
    \end{lequation}
    定态方程可以写为:
    \begin{lequation}
        \hat{H}\ket{\psi_n}=E_n\ket{\psi_n}\Rightarrow\bra{\psi_n}\hat{H}=E_n\bra{\psi_n}
    \end{lequation}
    在能量表象下, \ref{eq:3.39}变为:
    \[i\hbar\Braket{\psi_n|\frac{\partial}{\partial t}|\Psi(t)}=\Braket{\psi_n|\hat{H}|\Psi(t)}\]
    又因为$\ket{\psi_n}$与时间无关\footnote[2]{因为$\hat H$不显含时间, 我们始终可以选取一组与时间无关的定态作为基底}, 那么上式又可以写为：
    \begin{align*}
        i\hbar\frac{\partial}{\partial t}\Braket{\psi_n|\Psi(t)}&=\Braket{\psi_n|\hat{H}|\Psi(t)}\\
        &=E_n\Braket{\psi_n|\Psi(t)}
    \end{align*}
    \[i\hbar\frac{d}{dt}c_n(t)=E_n c_n(t)\]
    对时间积分得到：
    \[c_n(t)=c_n(t_0)e^{-iE_n(t-t_0)/\hbar}\]
    为了方便, 有时我们从初态开始计时,$t_0=0$, 方程也就变成了我们经常看见的\ref{wiggle-function}。

    所以, 要计算态随时间的演化, 我们先解出系统的能量本征态(定态), 然后根据初态对能量表象展开计算出对应的$c_n(t_0)$
    $$c_n(t_0)=\Braket{\psi_n|\Psi(t_0)}$$
    然后再对于每个$c_n$乘上对应的波动项即可:
    \begin{equation}
        \ket{\Psi(t)}=\sum_n c_n(t_0)e^{-iE_n(t-t_0)/\hbar}\ket{\psi_n}
    \end{equation}

    这里再次强调一下, 按照上面的做法, 可以发现定态, 即能量本征态随时间的演化始终只是乘上一个$e^{i\theta}$, 而我们提到过这种成比例的态在物理上是不可区分的, 所以
    定态的一切物理性质都不会随时间改变。而其它的算符对应的定值态就不一定有这样的性质了, 只是每次对相应力学量的测量都返回同一个值(这个本征态对应的本征值), 而不像定态一样是所有物理性质不随时变。


    \chapter{三维空间的量子力学}
    \section{三维薛定谔方程求解}
    量子力学在三维空间的推广非常自然, 我们只需要把动量和位置算符都改成上一章已经提及的三维形式($\hat{\bm{R}}$和$\hat{\bm{P}}$)即可, 在位置表象下, 三维薛定谔方程便写为：
    \begin{lequation}
        \boxed{
            i\hbar\frac{\partial \Psi\left(\bm{r},t\right)}{\partial t}=\left[-\frac{\hbar^{2}}{2m}\nabla^{2}+
            V\left(\bm{r},t\right)\right]\Psi\left(\bm{r},t\right) 
        }
    \end{lequation}
    如果势能不显含时间项, 那么薛定谔方程依然是可以分离变量求定态解的：
    \begin{lequation}
        \label{eq:4.2}
        \boxed{
            \left[-\frac{\hbar^{2}}{2m}\nabla^{2}+
            V\left(\bm{r}\right)\right]\psi\left(\bm{r}\right)=E\psi \left(\bm{r}\right)
        }
    \end{lequation}
    
    时间依赖项依然是$e^{-iEt/\hbar}$, 这些定态解构成了一组规范正交完备基, 它们的线性组合也就是真正的解, 这里的说法和第二章第三章没有多大差别, 第三章我们就已经通过
    抽象的语言直接使用态矢量去描述了, 所以这种近乎照搬的推广也不应感到意外。

    现在我们真正要去解偏微分方程了, 在讨论它更一般的解之前, 我们先来用它讨论一维无限深势阱在三维情况下的推广, 这时势函数具有下面的性质：
    \begin{equation}
        V(\bm{r})=\begin{cases}
            0&,0\leq x,y,z \leq a\\
            \infty &,\text{else}
            \end{cases}
    \end{equation}
    也就是说粒子被限制在一个盒子里面移动。
    \begin{thinknote}
        \textbf{解}:


        \setlength\parindent{2em}显然在区域$[0,a]\times[0,a]\times[0,a]$外部波函数的值为$0$, 在内部定态薛定谔方程可以写为：
        \begin{equation}
            \label{eq:4.4}
            -\frac{\hbar^2}{2m}\nabla^2\psi=E\psi
        \end{equation} 
        这是一个具有Dirichlet条件的Possion方程, 在这种边界为长方体的情况下, 解是可以分离变量的, 也就是说$\psi(\bm{r})$可以写成：
        \begin{equation}
            \psi(x,y,z)=A(x)B(y)C(z)
        \end{equation}
        代入\ref{eq:4.4}得到：
        \begin{equation}
            \frac{1}{A}\frac{d^2A}{dx^2}+\frac{1}{B}\frac{d^2B}{dy^2}+\frac{1}{C}\frac{d^2C}{dz^2}=-\frac{2mE}{\hbar^2}
        \end{equation}
        上式左边的三项分别依赖于三个不同的独立变量, 最后相加是常数, 所以最终只能是都是常数, 得到：
        \begin{lequation}
            \begin{cases}
                \frac{1}{A}\frac{d^2A}{dx^2}=-\frac{2mE_1}{\hbar^2}\\
                \frac{1}{B}\frac{d^2B}{dy^2}=-\frac{2mE_2}{\hbar^2}\\
                \frac{1}{C}\frac{d^2C}{dz^2}=-\frac{2mE_3}{\hbar^2}
            \end{cases}
        \end{lequation}
        其中$E_1+E_2+E_3=E$, 我们得到的这三个方程恰好就是之前在一维情况下已经推导过的, 它只具有束缚态的解, 所有舒服态的解构成了一个完备基, 令$k_i=\frac{\sqrt{2mE_i}}{\hbar}$, 根据
        第二章的分析我们直接得到：
        \begin{lequation}
            \begin{cases}
                A(x)=\sqrt{\frac{2}{a}}\sin\left(\frac{n_1\pi}{a}x\right)\\
                B(x)=\sqrt{\frac{2}{a}}\sin\left(\frac{n_2\pi}{a}y\right)\\
                C(x)=\sqrt{\frac{2}{a}}\sin\left(\frac{n_3\pi}{a}z\right)
            \end{cases}
        \end{lequation}
        综上, 我们便得到了定态解：
        \begin{equation}
            \Psi_n(\bm{r},t)=\left(\frac{2}{a}\right)^\frac{3}{2}\sin\left(\frac{n_1\pi}{a}x\right)\sin\left(\frac{n_2\pi}{a}y\right)\sin\left(\frac{n_3\pi}{a}z\right)e^\frac{-iE_nt}{\hbar}
        \end{equation}
        其中能量$E_n$需要三个参数去确定：
        \[E_n=\left(n_1^2+n_2^2+n_3^2\right)\frac{\pi^2\hbar^2}{2ma^2},\qquad(n_i=1,2,3,4,5,\cdots)\]
        这个时候同一个能量显然对应多组$\left(n_1,n_2,n_3\right)$, 所以这个三维束缚态每个能级并不都是简并的。
    \end{thinknote}
    \subsection*{极坐标下的薛定谔方程}
    对于一类中心势场, 势函数具有各向同性, 也就是说势函数只与$\bm{r}$的模长有关, 和其方向无关, 势函数退化为$V(r)$。由于这种独特的球对称性, 我们考虑在球坐标系下
    重新写出定态薛定谔方程。

    根据附录$\S \rm{A}.3$, 我们得到拉普拉斯算符在极坐标下的表示为：
    \begin{equation}
        \nabla^{2}=\frac{1}{r^{2}} \frac{\partial}{\partial r}\left(r^{2} \frac{\partial}{\partial r}\right)+\frac{1}{r^{2} \sin \theta} \frac{\partial}{\partial \theta}\left(\sin \theta \frac{\partial}{\partial \theta}\right)+\frac{1}{r^{2} \sin ^{2} \theta}\left(\frac{\partial^{2}}{\partial \phi^{2}}\right)
    \end{equation}
    那么式\ref{eq:4.2}便改写成：
    \begin{equation}
        \label{eq:4.11}
        -\frac{\hbar^{2}}{2 m}\left[\frac{1}{r^{2}} \frac{\partial}{\partial r}\left(r^{2} \frac{\partial \psi}{\partial r}\right)+\frac{1}{r^{2} \sin \theta} \frac{\partial}{\partial \theta}\left(\sin \theta \frac{\partial \psi}{\partial \theta}\right)+\frac{1}{r^{2} \sin ^{2} \theta}\left(\frac{\partial^{2} \psi}{\partial \phi^{2}}\right)\right]+V \psi=E \psi
    \end{equation}
    再次使用分离变量法去求解薛定谔方程\footnote[1]{Hassani在其名著\textit{Mathematical in Physics}中有一句话, 大意是说我们物理学中所关心的方程几乎都能分离变量去解。}, 令
    \[\psi(r,\theta,\phi)=R(r)Y(\theta,\phi)\]
    代入\ref{eq:4.11}得到:
    \begin{equation}
        \left\{\frac{1}{R} \frac{d}{d r}\left(r^{2} \frac{d R}{d r}\right)-\frac{2 m r^{2}}{\hbar^{2}}[V(r)-E]\right\}+\frac{1}{Y}\left\{\frac{1}{\sin \theta} \frac{\partial}{\partial \theta}\left(\sin \theta \frac{\partial Y}{\partial \theta}\right)+\frac{1}{\sin ^{2} \theta} \frac{\partial^{2} Y}{\partial \phi^{2}}\right\}=0
    \end{equation}
    再次, 我们又利用到两项依赖于不同的独立变量, 得到：
    \begin{align}
        &\frac{1}{R} \frac{d}{d r}\left(r^{2} \frac{d R}{d r}\right)-\frac{2 m r^{2}}{\hbar^{2}}[V(r)-E]=\ell(\ell+1) \label{eq:4.13}\\
        &\frac{1}{Y}\left\{\frac{1}{\sin \theta} \frac{\partial}{\partial \theta}\left(\sin \theta \frac{\partial Y}{\partial \theta}\right)+\frac{1}{\sin ^{2} \theta} \frac{\partial^{2} Y}{\partial \phi^{2}}\right\}=-\ell(\ell+1)\label{eq:4.14}
    \end{align}
    其中$\ell\in\mathbbm{C}$.
    \subsection*{角向解}
    首先我们来看方程\ref{eq:4.14}, 其中不含势能项, 是可以求出一般解的。这个方程实际上会在电动力学问题求解Laplace方程中得到, 还是利用分离变量法, 令：
    \[Y(\theta,\phi)=\Theta(\theta)\Phi(\phi)\]
    代入\ref{eq:4.14}得到：
    \begin{equation}
        \left\{\frac{1}{\Theta}\left[\sin \theta \frac{d}{d \theta}\left(\sin \theta \frac{d \Theta}{d \theta}\right)\right]+\ell(\ell+1) \sin ^{2} \theta\right\}+\frac{1}{\Phi} \frac{d^{2} \Phi}{d \phi^{2}}=0
    \end{equation}
    我们便得到了两个常微分方程：
    \begin{gather}
        \frac{1}{\Theta}\left[\sin \theta \frac{d}{d \theta}\left(\sin \theta \frac{d \Theta}{d \theta}\right)\right]+\ell(\ell+1) \sin ^{2} \theta=m^2\label{eq:4.16}\\
        \frac{1}{\Phi} \frac{d^{2} \Phi}{d \phi^{2}}=-m^2\label{eq:4.17}
    \end{gather}
    式\ref{eq:4.17}的解为:
    \begin{equation}
        \label{eq:4.18}
        \Phi(\phi)=ce^{imt}+de^{-imt},\qquad\text{(c,d为任意常数)}
    \end{equation}
    由于薛定谔方程是线性方程, 所以重点是找到一组线性无关解, 那么上面的解可以简写为
    \[\Phi(\phi)=e^{imt}\]
    只要允许$m$是负值即可, 这些解和\ref{eq:4.18}表示的解是等价的, 我们把前面的常数因子纳入到$\Theta$中了, 最后再归一化一并求出。
    
    $\Phi$还需要满足边界条件$\Phi(\phi+2\pi)=\Phi(\phi)$, 所以$m$只能取整数：
    \begin{equation}
        \boxed{\Phi(\phi)=e^{imt}, \quad(m=0,\pm 1,\pm 2,\pm 3\ldots)}
    \end{equation}

    方程\ref{eq:4.16}的求解在一般的数理方法书中都会提到, 它的解可以用\textbf{连带勒让德函数表达}\footnote[1]{当然, 这个方程还有别的解, 但没有物理意义, 详见数学物理方法内容}：
    \begin{equation}
        \Theta(\theta)=AP_\ell^m\left(\cos\left(\theta\right)\right),\quad(\ell=0,1,2\ldots)
    \end{equation}
    \begin{define}{勒让德函数}
        \begin{lequation}
            P_\ell(x)\equiv\frac{1}{2^\ell\ell!}\left(\frac{d}{dx}\right)^\ell\left(x^2-1\right)^2
        \end{lequation}
    \end{define}
    \begin{define}{连带勒让德函数}
        \begin{lequation}
            P_\ell^m\equiv(-1)^m\left(x^2-1\right)^\frac{m}{2}\left(\frac{d}{dx}\right)^mP_\ell(x),\quad(m>0)
        \end{lequation}
        \begin{lequation}
            P_\ell^{-m}=(-1)^m\frac{\left(\ell-m\right)!}{\left(\ell+m\right)!}P_\ell^m(x)
        \end{lequation}
    \end{define}
    现在完全确定一个定态解的角向函数需要给出$l$和$m$两个参数, 而且根据上面的定义, 在$\ell$确定后, $m$只能取某些固定的值才能使方程\ref{eq:4.16}有(含物理意义的)解。即：
    \[\ell=0,1,2\ldots\Rightarrow m=0,\pm 1,\pm 2,\pm 3,\ldots, \pm \ell\]
    最后归一化\footnote[1]{不要忘记三重积分球坐标换元后的雅可比系数}我们得到:
    \begin{lequation}
        \boxed{Y_{\ell}^{m}(\theta, \phi)=\sqrt{\frac{(2 \ell+1)}{4 \pi} \frac{(\ell-m) !}{(\ell+m) !}} e^{i m \phi} P_{\ell}^{m l}(\cos \theta)}
    \end{lequation}
    在数学上被称为\textbf{球谐函数}, 满足：
    \begin{equation}
        \int_{0}^{\pi} \int_{0}^{2 \pi}\left[Y_{\ell}^{m}(\theta, \phi)\right]^{*}\left[Y_{\ell^{\prime}}^{m^{\prime}}(\theta, \phi)\right] \sin \theta d \theta d \phi=\delta_{\ell \ell^{\prime}} \delta_{m m^{\prime}}
    \end{equation}
    \subsection*{径向求解}
    方程\ref{eq:4.13}的求解必须要在知道具体的势函数后才能完全求解, 但是我们可以做换元：
    \[R(r)=\frac{u(r)}{r}\Rightarrow \frac{dR}{dr}=\frac{1}{r}\frac{du}{dr}-\frac{u}{r^2}\]
    方程\ref{eq:4.13}可以写为：
    \begin{lequation}
        \label{eq:4.26}
        \boxed{
            -\frac{\hbar^2}{2m}\frac{d^2u}{dr^2}+\left[V(r)+\frac{\hbar^2}{2m}\frac{\ell\left(\ell+1\right)}{r^2}\right]u(r)=Eu(r)
        }
    \end{lequation}
    与一维的定态薛定谔方程对比：
    \[-\frac{\hbar^2}{2m}\frac{d^2\psi}{dx^2}+V\psi=E\psi\]
    径向方程\ref{eq:4.26}等价于一个\uwave{有效势能}为
    \begin{equation}
        \label{eq:4.27}
        V_{\text{eff}}(r)=V(r)+\frac{\hbar^2}{2m}\frac{\ell\left(\ell+1\right)}{r^2}
    \end{equation}
   的一维粒子波函数方程。
    
    经典力学中我们解决中心力场问题时, 在质心系下系统的拉格朗日量可以写成：
    \[\mathcal{L}=\frac{1}{2}\mu\bm{r}^2-V(\bm{r})\]
    其中$\bm{r}$是相对位矢, $\mu$是二体约化质量。使用极坐标重写上面的拉格朗日量为:
    \[\mathcal{L}=\frac{1}{2}\mu\left(\dot{r}^2+\dot{\theta}^2r^2\right)-V({r})\]
    利用角动量$J=\mu\dot{\theta}r^2$守恒, 上面的拉格朗日量可以写成完全不依赖于$\theta$的形式：
    \[\mathcal{L}=\frac{1}{2}\mu\dot{r}^2-\left[V({r})+\frac{J^2}{2mr^2}\right]\]
    定义等效势能：
    \[V_{\text{eff}}(r)=V(r)+\frac{J^2}{2mr^2}\]
    
    根据拉格朗日量可以写出径向的运动方程, 和一个在等效势场下运动的一维粒子等价。我们将等效势能中的第二项称为\textbf{离心势能}, 在转动非惯性系下, 离心力是一个保守力
    可以定义势能, 势能的形式正是一个关于$\bm{r}$的二次型的形式。事实上, 我们如果在跟随系统转动的参考系下写拉格朗日量, 这一项的出现会非常自然。
    
    现在, 回到量子力学, 量子力学相对于对经典力学, 力学量变成了算符, 经典态变成了量子态。沿用经典力学的一些说法, 我们也称\ref{eq:4.27}中的第二项为\textbf{离心项}。
    下面求解一个具体的问题。
    \begin{define}{无限深球形势阱}
        \begin{equation}
          V(r)=\begin{cases}
            0,&r\leq a\\
            \infty,&r>a
            \end{cases}  
        \end{equation}
    \end{define}
    在外部$u(r)=0$, 在内部定态方程可以写为：
    \begin{equation}
        \frac{d^2u}{dr^2}=\left[\frac{\ell\left(\ell+1\right)}{r^2}-k^2\right]u,\quad k\equiv\frac{\sqrt{2mE}}{\hbar}
    \end{equation}
    $\ell=0$时, 方程的解和一维无限深势阱非常相似
    \[R(r)=\frac{u(r)}{r}=A\frac{\sin(kr)}{r}+B\frac{\cos(kr)}{r}\]
    $r\to0$时, $R(r)\to \frac{1}{r}\Rightarrow \Psi(\bm{r})\to \frac{1}{r}$, 由于$\nabla^2\left(\frac{1}{r}\right)=-4\pi\delta(r)$, 薛定谔方程:
    \[-\frac{\hbar^2}{2m}\nabla^2\Psi=E\Psi\]
    左边是病态delta函数, 右边是一个解析函数, 显然无法满足。所以$B$必须为$0$, 否则在$r=0$时不满足薛定谔方程, 而且由于$u(a)=0$, $k$的取值也有一定限制, $ka=N\pi$, $N$是自然数。
    再根据归一化条件：\[
        \iiint d^3r\left|\Psi(\bm{r})\right|^2=\int r^2\left|R(r)\right|^2dr\iint\limits_{\theta,\phi}\left|Y_\ell^m(\theta,\phi)\right|^2d\theta d\phi\]
    球谐函数已经归一化, 所以解得\footnote[1]{这里的下标"0"是指$ell=0$}
    \begin{equation}
        u_{N0}=\sqrt{\frac{2}{a}}\sin\left(\frac{N\pi r}{a}\right),\quad E=\frac{N^2\pi^2\hbar^2}{2ma^2}
    \end{equation}

    $\ell\neq 0$时方程的解是特殊函数:
    \[u(r)=Arj_\ell(kr)+Brn_\ell(kr)\]
    \begin{define}{球贝塞尔函数}
        \begin{equation}
            j_\ell(x)\equiv(-x)^\ell\left(\frac{1}{x}\frac{d}{dx}\right)^\ell\frac{\sin x}{x}
        \end{equation}
        \[x\to 0\Rightarrow j_\ell(x)\to\frac{2^\ell \ell!}{(2\ell+1)!}x^\ell \to 0\]
    \end{define}
    \begin{define}{球诺伊曼函数}
        \begin{equation}
            n_\ell(x)\equiv-(-x)^\ell\left(\frac{1}{x}\frac{d}{dx}\right)^\ell\frac{\cos x}{x}
        \end{equation}
        \[x\to 0\Rightarrow n_\ell(x)\to-\frac{(2\ell)!}{2^\ell \ell!}\frac{1}{x^{\ell+1}}\to \infty \]
    \end{define}
    按照之前的方法不难得出$B=0$, 再根据边界条件得出：
    \[R(r)=Aj_\ell(kr),ka=\beta_{N\ell},N=1,2,\ldots\]
    其中$\beta_{N\ell}$指$j_l(x)$的第$N$个零点。对应的定态解的能量为：\[E_{N\ell}=\frac{\hbar^2}{2ma^2}\beta_{N\ell}^2\]
    
    之前一维问题求解定态解时(非简并情况), 我们要确定定态解中的某个量子态只需要知道一个参数$n$, 也就是能级, 结合问题本身我们就能唯一确定这个量子态。但是在
    三维情况下, 大多问题都是简并的, 我们确定一个量子态就需要$N,m,\ell$三个参数。其中我们仿照一维问题再引入一个量子数$n$, 常被称为\textbf{主量子数}, 与
    能量直接相关。按照能量$E_{N\ell}$的大小排列可以确定这个量子数, 也就是说$n$与$N,\ell$相关。

    \section{氢原子}
    \subsection{波函数求解}
    我们现在要考虑的是氢原子核外电子的波函数, 由于质子的质量远大于电子, 所以可以认为电子在库仑中心势场中运动\[V(r)=-\frac{e^2}{4\pi\epsilon_0}\frac{1}{r}\]
    径向定态薛定谔方程写成：
    \begin{equation}
        \label{eq:4.33}
        -\frac{\hbar^2}{2m_e}\frac{d^2u}{dr^2}+\left[\frac{e^2}{4\pi\varepsilon_0}\frac{1}{r}+\frac{\hbar^2}{2m_e}\frac{\ell(\ell+1)}{r^2}\right]u=Eu
    \end{equation}
    等效势能为\[V_{\text{eff}}=\frac{e^2}{4\pi\varepsilon_0}\frac{1}{r}+\frac{\hbar^2}{2m}\frac{\ell(\ell+1)}{r^2}\]
    
    显然, 根据我们解一维薛定谔方程的经验, $E<0$为束缚态, $E>0$为散射态。其实这又可以和经典力学中的开普勒问题类比, 开普勒问题中, 运动轨迹为圆锥曲线, 当且仅当
    $E<0$时轨道为椭圆, 为束缚态。其它情况下轨道为抛物线或者双曲线, 也就是说这个时候粒子运动没有被限制在一定的空间范围中, 也即散射态。我们下面的讨论中主要考虑束缚态情况。

    定义$\kappa\equiv\frac{\sqrt{-2m_eE}}{\hbar}$, 我们可以将\ref{eq:4.33}改写为：
    \begin{equation}
        \label{eq:4.34}
        \frac{1}{\kappa^2}\frac{d^2u}{dr^2}+\left[\frac{m_ee^2}{2\pi\varepsilon_0\hbar^2\kappa}\frac{1}{\kappa r}-\frac{\ell\left(\ell+1\right)}{\left(\kappa r\right)^2}\right]u=u
    \end{equation}
    我们再做换元\[\rho=\kappa r,\quad \rho_0=\frac{m_ee^2}{2\pi\varepsilon_0\hbar^2\kappa}\]
    \ref{eq:4.34}写为(注意这里$u$变成了关于$\rho$的函数):
    \begin{equation}
        \label{eq:4.35}
        \frac{d^2u}{d\rho^2}=\left[1+\frac{\ell\left(\ell+1\right)}{\rho^2}-\frac{\rho_0}{\rho}\right]u
    \end{equation}
    我们考察下这个方程的渐进解:
    \begin{itemize}
        \item $\rho\to\infty$\\
                方程\ref{eq:4.35}形式变为:
                \[\frac{d^2u}{d\rho^2}=u\]
                那么在$\rho $充分大时, 方程的解应该具有如下形式：\[u_\infty=Ae^{-\rho}+Be^{+\rho}\]
                显然根据波函数有界性, 有$B=0$, 故$u_\infty\sim e^{-\rho}$.
        \item $\rho\to 0$\\
                方程\ref{eq:4.35}形式变为:
                \[\frac{d^2u}{d\rho^2}=\frac{\ell\left(\ell+1\right)}{\rho^2}u\]
                这是一个Euler方程, 解得$\rho$充分小时, 方程解的形式为：\[u_0=C\rho^{\ell+1}+D\rho^{-\ell}\]
                同样根据波函数的有界性, 有$D=0$, 故$u_0\sim \rho^{\ell+1}$.
    \end{itemize}
    
    有了上面的讨论, 我们从$u(\rho)$中分离出渐进解, 下面的变换也显得比较自然：
    \[u=\rho^{\ell+1}e^{-\rho}v(\rho)\]
    $v(\rho)$是个未知函数, 下面我们将方程\ref{eq:4.35}转换为关于$v(\rho)$的方程：
    \begin{equation}
        \label{eq:4.36}
        \rho\frac{d^2v}{d\rho^2}+2\left(\ell+1-\rho\right)\frac{dv}{d\rho}+\left(\rho_0-2\ell-2\right)v=0
    \end{equation}
    
    方程在形式上好像并没有变得更加简单, 但是分离出渐进解后, 会让我们后面的级数解讨论变得更加简洁。
    
    为了解\ref{eq:4.36}, 我们设：
    \[v(\rho)=\sum\limits_{j=0}c_j\rho^j\Rightarrow\frac{dv}{d\rho}=\sum\limits_{j=0}\left(j+1\right)c_{j+1}\rho^j,\frac{d^2v}{d\rho^2}=\sum\limits_{j=0}j\left(j+1\right)c_{j+1}\rho^{j-1}\]
    代入原方程得到递推公式：
    \begin{equation}
        \label{eq:4.37}
        c_{j+1}=\frac{2\left(j+\ell+1\right)-\rho_0}{\left(j+1\right)\left(j+2\ell+2\right)}c_j
    \end{equation}
    $j$充分大时, 上式变为\footnote[1]{你也可以近似的更狠一点, 把分母中的1拿掉, 也可以导出正确的结果, 但是推导略微复杂一点。}:
    \[c_{j+1}=\frac{2}{j+1}c_j\Rightarrow c_j\approx\frac{2^j}{j!}c_0\Rightarrow v(\rho)=c_0e^{2\rho}\]
    那么我们得到了一个$u(\rho)$的渐进解：
    \[u(\rho)=c_0e\rho\rho^{\ell+1}\]
    显然不满足$\rho\to\infty$时的波函数有界性要求, 所以这个解并不具有物理意义, 回忆一下我们在求解一维谐振子模型中使用过的技巧, 为了让最终的解具有物理意义,
    只能是递推公式\ref{eq:4.37}在某处截断, 这样$j$充分大时$c_j$为$0$.

    假设$c_N=0$且$c_{N-1}\neq 0$, 那么：
    \[2\left(N+\ell\right)-\rho_0=0\]
    $n\equiv N+\ell$, 为主量子数\footnote[1]{由于历史原因, $\ell$称为\textbf{角量子数}, $m$称为\textbf{磁量子数}}, 根据$\rho_0$的定义式, 我们得到:
    \begin{lequation}
        \boxed{
            E_n=-\frac{m_e}{2\hbar^2}\left(\frac{e^2}{4\pi\varepsilon_0}\right)^2\frac{1}{n^2}\equiv\frac{E_1}{n^2}, n=1,2,3\ldots
        }
    \end{lequation}
    其中：
    \begin{lequation}
        \boxed{
            E_1=-\frac{m_e}{2\hbar^2}\left(\frac{e^2}{4\pi\varepsilon_0}\right)^2=\SI{-13.6}{\eV}
        }
    \end{lequation}
    这个公式称为\textbf{波尔公式}, 可以称得上是量子力学发展史中的一个里程碑, 结合$\kappa$的定义式可以得到：
    \[\kappa=\left(\frac{m e^{2}}{4 \pi \varepsilon_{0} \hbar^{2}}\right) \frac{1}{n}=\frac{1}{a n}\]
    其中
    \begin{equation}
        \boxed{
            a\equiv\frac{4 \pi \varepsilon_{0} \hbar^{2}}{m e^{2}}=\SI{0.592}{\angstrom}
        }
    \end{equation}
    称为\textbf{玻尔半径}。薛定谔方程在1924年才被给出, 玻尔当时使用半经典半量子的方法在1913年“推导”出了这些公式。
    在继续我们下面的推导之前, 我认为花点功夫介绍一下波尔当时推导出来这个公式的思路是必要的。
    \begin{history}{波尔公式}
        \setlength\parindent{2em}其实对于氢原子的离散谱线的解释, 当时已经有诸如巴尔末公式等经验公式。玻尔主要的思想还是经典力学那一套, 认为电子在核外做圆周运动, 库仑力充当向心力, 那么：
        \[\frac{e^2}{4\pi\varepsilon_0r^2}=m\frac{v^2}{r}\]
        然后玻尔认为电子的轨道是离散的, 进一步应该认为电子绕核运动的角动量只能取一系列离散的值：
        \[L_z=mvr=n\hbar,\quad (n=1,2,3\ldots)\]
        结合第一个运动方程：
        \[r=n^2\frac{4\pi\varepsilon_0\hbar^2}{m_ee^2}\equiv n^2 a\]
        电子的总能量(当然这又是经典的考虑, 只计动能和势能)：
        \[E=-\frac{1}{2}\frac{e^2}{4\pi\varepsilon_0r}\Rightarrow E_n=\frac{E_1}{n^2}\]
        
        \setlength\parindent{2em}不难验证基态能量$E_1$和玻尔半径$a$都和我们使用量子力学的解一致。不过我们之前计算的都是量子力学的图象, 这里只能说使用经典方法凑了个巧。$E_1$也被称为
        氢原子的\textbf{结合能}, 表示了电离核外电子需要多少能量。
        
        \setlength\parindent{2em}当然, 现在看来玻尔当时的想法是非常荒诞的, 在试图用一个经典的图像解释一个量子力学问题, 但是不得不说这一量子化的想法对今后量子力学的建立还是起到了很大的推动作用, 特别是
        玻尔使用这个模型很好的解释了外层电子为$1$的原子的光谱, 但就连铍也无法再用这个模型解释。
    \end{history}
    由于$N\in\mathbbm{N}^*$, 所以当主量子数确定时, 角量子数的可取值只能为：
    \[\ell=0,1,2,\ldots,n-1\]
    求解角向薛定谔方程时我们就知晓了磁量子数和角量子数之间的取值关系, 所以能级$E_n$的简并度为:
    \[d_n=\sum\limits_{\ell=0}^{n-1}{\left(2\ell-1\right)}=n^2\]

    $n$取$1$时, 根据上面的讨论, $\ell,m$的取值只能是$0$
    \[\psi_{100}=R_{10}Y_0^0=\frac{1}{\sqrt{4\pi}}R_{10},\quad R_{n\ell}=\frac{1}{r}\rho^{\ell+1}e^{-\rho}v(\rho)\]
    $n=1$时, $c_1=0$, 故$v(\rho)=c_0$, 再根据$\rho=\kappa r=\frac{r}{n a}$, 对波函数进行归一化求得$c_0$后得到基态定态波函数解：
    \begin{lequation}
        \boxed{\psi_{100}(r,\theta,\phi)=\frac{1}{\sqrt{\pi a^3}}e^{-\frac{r}{a}}}
    \end{lequation}
    \begin{thinknote}
        这里要格外注意, 粒子并非最有可能出现在半径为$r=0$的球面上, 虽然波函数的值随着半径的增大而减小, 但是球面面积也在变大, 而波函数的概率解释是与体积元相关的。
        也就是说\[P=\left|\psi_{100}(r,\theta,\phi)\right|^2dV\]在直角坐标中$dV=dxdydz$, 球坐标中$dV=r^2\sin\theta drd\theta d\phi$.这里对于一个球面, 我们应当使用积分
        去计算粒子出现在半径为$r\sim r+dr$的球壳内的概率, 根据波函数球对称性很容易得到：\[P(r)=\frac{4}{a^3}r^2e^{-2r/a}dr\]
        求得上式在$r=a$的时候取极大值, 所以玻尔使用经典理论预测到\uwave{轨道半径}为$a$在量子力学上看就是求出了最概然位置。
    \end{thinknote}
    \begin{define}{拉盖尔函数}
        \begin{equation}
            L_q\equiv\frac{e^x}{q!}\left(\frac{d}{dx}\right)^q\left(e^{-x}x^q\right)    
        \end{equation}
    \end{define}
    \begin{define}{连带拉盖尔函数}
        \begin{equation}
            L_q^p(x)\equiv(-1)^p\left(\frac{d}{dx}\right)^pL_{p+q}(x)=\frac{x^{-p}e^x}{q!}\left(\frac{d}{dx}\right)^q\left(e^{-x}x^{p+q}\right)
        \end{equation}
    \end{define}
    $v(\rho)$可以利用拉盖尔函数写成(已经略去前面的归一化常数)：
    \begin{equation}
        v(\rho)=L_{n-\ell-1}^{2\ell+1}(2\rho)
    \end{equation}
    最后归一化后得到定态解为：
    \begin{equation}
        \boxed{
            \psi_{n \ell m}=\sqrt{\left(\frac{2}{n a}\right)^{3} \frac{(n-\ell-1) !}{2 n(n+\ell) !}} e^{-r / n a}\left(\frac{2 r}{n a}\right)^{\ell}\left[L_{n-\ell-1}^{2 \ell+1}(2 r / n a)\right] Y_{\ell}^{m}(\theta, \phi)
        }
    \end{equation}
    而且由三个量子数确定的定态解是一组完备的正交归一基, 我们不用再进行施密特正交化了！
    \begin{equation}
        \int d^3r \psi_{n\ell m}^*\psi_{n^\prime\ell^\prime m^\prime}=\delta_{nn^\prime}\delta_{\ell \ell^\prime}\delta_{mm^\prime}
    \end{equation}
    
    其中$\ell$和$m$之间的正交归一性是球谐函数的性质, $n$的正交归一性可以由$\hat{H}$属于不同本征值的本征向量正交性得出。也就是说, 从代数结构上看, $n$确定
    本征空间, 由于三维量子力学中简并态的普遍性, $\ell$和$m$是在这个本征空间中寻找基底。
    \subsection{氢原子光谱}
    一般情况下, 氢原子处于基态, 但是当它吸收能量之后便会\textbf{跃迁}到激发态, 里面的具体机制我们不探究, 我们还是按照中学的知识来大致解释。氢原子吸收光子的能量, 当且仅当吸收的能量是两
    能级之差时发生跃迁, 否则不吸收能量, 这个时候产生的谱线称为\textbf{吸收谱}；反之, 氢原子自发的从激发态向低能级跃迁会向外发出对应能量的电磁辐射(光子形式), 这个时候产生的谱线称为\textbf{发射谱}。
    
    根据$E_n=E_1/n^2=-\SI{13.6}{eV}/{n^2}$和普朗克公式$E=h\nu$.可以得到从第$n_f$能级跃迁到$n_i$释放的光子的波长：
    \begin{equation}
        \label{eq:4.47}
        \frac{1}{\lambda}=\mathcal{R}\left(\frac{1}{n_f}-\frac{1}{n_i}\right)     
    \end{equation}
    其中:
    \[\mathcal{R} \equiv \frac{-E_1}{hc} = \frac{m_{e}}{4 \pi c \hbar^{3}}\left(\frac{e^{2}}{4 \pi \epsilon_{0}}\right)^{2}=1.097 \times 10^{7} \mathrm{~m}^{-1}\]
    称为\textbf{Rydberg constant}, \ref{eq:4.47}最先开始是作为经验公式给出的。
    \begin{itemize}
        \item $n_f=1$\quad 谱线位于紫外光区, 称为\textbf{Lyman series}
        \item $n_f=2$\quad 谱线位于可见光区, 称为\textbf{Balmer series}
        \item $n_f=3$\quad 谱线位于红外光区, 称为\textbf{Paschen series}
    \end{itemize}
    \section{角动量}
    在经典力学中, 粒子的角动量定义为:\[\bm{L}=\bm{r}\times\bm{p}\]写成分量形式为:\[L_x=yp_z-zp_y,L_y=zp_x-xp_z,L_z=xp_y-yp_x\]
    涉及到经典力学中的两个力学量相乘转换为算符时, 可能要考虑一下算符结合的顺序, 但是好在这里我们不需要考虑, 因为正则对易关系的三维形式为:
    \begin{equation}
        \left[r_i,p_j\right]=i\hbar\delta_{ij}\quad\left[r_i,r_j\right]=\left[p_i,p_j\right]=0
    \end{equation}
    显然角动量涉及到的都是两个可对易算符相乘。
    
    我们先来计算这三个角动量分量算符之间的对易子\footnote[1]{后面的推导中我们一律略去算符上面的$\hat{}$}:
    \begin{align*}
        \left[L_x,L_y\right]&=\left[yp_z-zp_y\right]\\&=\left[yp_zz,zp_x\right]-\left[y,x\right]p_z-z\left[p_y,p_x\right]+\left[zp_y,xp_z\right]
        \\&=yp_zzp_x-zp_xyp_z+zp_yxp_z-xp_zzp_y\\&=yp_x\left[p_z,z\right]-xp_y\left[p_z,z\right]\\&=\left[z,p_z\right]L_z
        \\&=i\hbar L_z
    \end{align*}
    根据自变量的$x\to y\to z\to x$轮换性, 我们得到:
    \begin{lequation}
        \label{eq:4.48}
        \boxed{
            \left[L_x,L_y\right]=i\hbar L_z,\left[L_y,L_z\right]=i\hbar L_x,\left[L_z,L_x\right]=i\hbar L_y
        }
    \end{lequation}

    \subsection*{$L^2$和$L_z$的本征矢}
    根据$\S 3.4$的讨论, 不对易的算符找不到一组共同的本征矢, 但是对易的可以, 矩阵的观点看来也即可以同时对角化。显然我们不应浪费时间在寻找三个分量算符之间的共同本征矢上面。
    根据\[L^2=L_x^2+L_y^2,L_z^2\]我们可以计算
    \begin{align*}
        \left[L^2,L_z\right]&=\left[L_x^2,L_z\right]+\left[L_y^2,L_z\right]+\left[L_z^2,L_z\right]
        \\ &=L_x\left[L_x,L_z\right]+\left[L_x,L_z\right]L_x+L_y\left[L_y,L_z\right]+\left[L_y,L_z\right]L_y
        \\ &=0
    \end{align*}
    第二个等号利用了下面的事实:\[\left[\hat{A}\hat{B},\hat{C}\right]=\hat{A}\left[\hat{B},\hat{C}\right]+\left[\hat{A},\hat{C}\right]\hat{B}\]
    第三个等号利用了正则对易关系。

    那么我们可以尝试去寻找$L^2$与某个分量算符之间的本征矢, 索性就取$L_z$, 对于某个共同本征矢有:
    \[L^2f=\lambda f,L_zf=\mu f\]
    我们下面利用的方法是$\S 2.3$中已经用到的\uwave{升降阶算符法}, 定义：
    \[L_\pm \equiv L_x\pm iL_y\]
    \begin{theorem}{$L_\pm f$也是$L^2$的本征矢}
        \begin{equation}
            \label{eq:4.50}
            L^2f=\lambda f\Rightarrow L_\pm L^2f=\lambda L_\pm f\Rightarrow L^2\left(L_\pm f\right)=\lambda\left(L_\pm f\right)
        \end{equation}
    \end{theorem}
    $L_\pm$的\uwave{升降}是针对$L_z$而言的:
    \begin{align*}
        \left[L_z,L_\pm\right]&=\left[L_z,L_x\right]+i\left[L_z,L_y\right]\\
        &=\pm \hbar L_\pm
    \end{align*}
    我们再来计算：
    \begin{align*}
        L_z\left(L_\pm f\right)&=\left[L_z,L_\pm\right]f+L_\pm L_\pm L_z f\\
        &=\pm\hbar \left(L_\pm f\right)+\mu \left(L_\pm f\right)\\
        &=\left(\mu\pm\hbar\right)\left(L_\pm f\right)
    \end{align*}
    根据上面的推导又可以得到下面的定理：
    \begin{theorem}{$L_\pm f$也是$L_z$的本征矢}
        \begin{equation}
            L_zf=\mu f\Rightarrow L_z\left({L_\pm}^nf\right)=\left(\mu + n\hbar\right){L_\pm}^nf
        \end{equation}
    \end{theorem}  
    以本征矢$f$为基础, 我们便可以使用$L_\pm$去生成本征值更大或者更小的$L_z$的本征矢, 而且依旧是$L^2$关于本征值$\lambda$的本征矢。但是这个“阶梯”是不能无限延伸的
    \begin{align*}
        \lambda^2=\braket{L^2}&=\braket{L_x^2}+\braket{L_y^2}+\braket{L_z^2}\\ &=\braket{L_x^2}+\braket{L_y^2}+\braket{f|L_z^2|f}\\
                    &=\braket{L_x^2}+\braket{L_y^2}+\braket{L_zf|L_zf}>\mu^2
    \end{align*}
    所以这个阶梯一定有一个顶端和一个底端, 暂且记为$f_t$和$f_b$, 且满足\footnote[1]{根据求谐振子的经验, 我们最终要让阶梯延伸终止, 也就是要让通过升降阶算符法得到的本征矢无法归一化, 这里直接选为$0$有些不明不白, 但是是可以证明的}:
    \[L_+f_t=0,L_-f_b=0\]
    相应的本征值设为：
    \[L_zf_t=\hbar \ell f_t,L_zf_b=\hbar \bar \ell f_b\]
    \begin{align*}
        L_\pm L_\mp&=\left(L_x\pm iL_y\right)\left(L_x\mp iL_y\right)\\
                   &=L_x^2+L_y^2\mp i\left[L_x,L_y\right]\\
                   &=L^2-L_z^2\pm \hbar L_z
    \end{align*}
    利用上式$L^2$可以表示为：
    \[L^2=L_z^2+L_\pm L_\mp \pm \hbar L_z\]
    依照$f_t$和$f_b$的定义：
    \begin{align*}
        L^2f_t&=L_z^2+L_- L_+ - \hbar L_z\\
        &=L_z^2f_t-\hbar L_zf_t\\
        &=\hbar^2\ell\left(\ell+1\right)f_t
    \end{align*}
    类似的推导可以得到
    \[ L^2f_b=\hbar^2\bar \ell\left(\bar \ell-1\right)f_b\]
    根据\ref{eq:4.50}, $f_t$和$f_b$都是$L^2$的关于$\lambda$的本征矢, 所以:
    \[\lambda=\hbar^2\ell\left(\ell+1\right)=\hbar^2\bar \ell\left(\bar \ell-1\right)\Rightarrow\bar \ell=-\ell\]
    显然根据升降阶算符的定义, $\bar\ell $和$\ell$之间肯定相差的一个整数, 故$2\ell=N$得出$\ell $取值为:
    \[\ell=0,\frac{1}{2},1,\frac{3}{2},\ldots\]
    当$\lambda$确定之后也便确定了$\ell$, 那么根据升降阶算符生成的两算符之间的共同本征矢可以使用$\ell$和$m$标识:
    \begin{equation}
        \begin{cases}
            L^2f_\ell^m=\hbar^2\ell\left(\ell+1\right)f_\ell^m\\
            L_zf_\ell^m=\hbar m f_\ell^m
        \end{cases}
    \end{equation}
    $m$取值为:$-\ell,-\ell+1,\cdot,\ell-1,\ell$

    求出了$L^2$所有的本征值$\lambda$后我们便确定了$\ell$的取值, $\ell$和$m$便一起标识了$L^2$和$L_z$的本征值, 下一步我们就是要去求出对应的一组共同的本征矢。
    当然, 这两个字母的设置绝不是空穴来风, 我们说氢原子定态解由三个量子数完全描绘, 主量子数$n$与能量相关, 角量子数$\ell $和磁量子数$m$与角动量相关。

    \subsection*{$L^2$和$L_z$的本征矢}
    \include{appendix.tex}
\end{document}